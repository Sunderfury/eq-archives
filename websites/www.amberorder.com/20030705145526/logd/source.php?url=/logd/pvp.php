<h1>View Source: /logd/pvp.php</h1><a href='#source'>Click here for the source,</a> OR<br><b>Other files that you may wish to view the source of:</b><ul><li><a href='source.php?url=/logd/about.php'>about.php</a></li>
<li><a href='source.php?url=/logd/armor.php'>armor.php</a></li>
<li><a href='source.php?url=/logd/armoreditor.php'>armoreditor.php</a></li>
<li><a href='source.php?url=/logd/badnav.php'>badnav.php</a></li>
<li><a href='source.php?url=/logd/bank.php'>bank.php</a></li>
<li><a href='source.php?url=/logd/battle.php'>battle.php</a></li>
<li><a href='source.php?url=/logd/bio.php'>bio.php</a></li>
<li><a href='source.php?url=/logd/common.php'>common.php</a></li>
<li><a href='source.php?url=/logd/configuration.php'>configuration.php</a></li>
<li><a href='source.php?url=/logd/connector.php'>connector.php</a></li>
<li><a href='source.php?url=/logd/create.php'>create.php</a></li>
<li><a href='source.php?url=/logd/creatures.php'>creatures.php</a></li>
<li>dbconnect.php &#151; this file cannot be viewed: it contains sensitive information specific to this installation.</li>
<li><a href='source.php?url=/logd/dbwrapper.php'>dbwrapper.php</a></li>
<li><a href='source.php?url=/logd/donators.php'>donators.php</a></li>
<li>dragon.php &#151; this file cannot be viewed: If you want to read the dragon script, I suggest you do so by defeating it!</li>
<li><a href='source.php?url=/logd/forest.php'>forest.php</a></li>
<li><a href='source.php?url=/logd/graveyard.php'>graveyard.php</a></li>
<li><a href='source.php?url=/logd/gypsy.php'>gypsy.php</a></li>
<li><a href='source.php?url=/logd/healer.php'>healer.php</a></li>
<li><a href='source.php?url=/logd/hof.php'>hof.php</a></li>
<li><a href='source.php?url=/logd/index.php'>index.php</a></li>
<li><a href='source.php?url=/logd/inn.php'>inn.php</a></li>
<li><a href='source.php?url=/logd/list.php'>list.php</a></li>
<li><a href='source.php?url=/logd/logdnet.php'>logdnet.php</a></li>
<li><a href='source.php?url=/logd/login.php'>login.php</a></li>
<li><a href='source.php?url=/logd/mail.php'>mail.php</a></li>
<li><a href='source.php?url=/logd/motd.php'>motd.php</a></li>
<li><a href='source.php?url=/logd/newday.php'>newday.php</a></li>
<li><a href='source.php?url=/logd/news.php'>news.php</a></li>
<li><a href='source.php?url=/logd/petition.php'>petition.php</a></li>
<li><a href='source.php?url=/logd/prefs.php'>prefs.php</a></li>
<li><a href='source.php?url=/logd/pvp.php'>pvp.php</a></li>
<li><a href='source.php?url=/logd/referers.php'>referers.php</a></li>
<li><a href='source.php?url=/logd/shades.php'>shades.php</a></li>
<li><a href='source.php?url=/logd/source.php'>source.php</a></li>
<li><a href='source.php?url=/logd/stables.php'>stables.php</a></li>
<li><a href='source.php?url=/logd/stats.php'>stats.php</a></li>
<li><a href='source.php?url=/logd/superuser.php'>superuser.php</a></li>
<li><a href='source.php?url=/logd/taunt.php'>taunt.php</a></li>
<li><a href='source.php?url=/logd/train.php'>train.php</a></li>
<li><a href='source.php?url=/logd/translator.php'>translator.php</a></li>
<li><a href='source.php?url=/logd/translator_de.php'>translator_de.php</a></li>
<li><a href='source.php?url=/logd/translator_dk.php'>translator_dk.php</a></li>
<li><a href='source.php?url=/logd/translator_en.php'>translator_en.php</a></li>
<li><a href='source.php?url=/logd/translator_es.php'>translator_es.php</a></li>
<li><a href='source.php?url=/logd/translator_fr.php'>translator_fr.php</a></li>
<li><a href='source.php?url=/logd/user.php'>user.php</a></li>
<li><a href='source.php?url=/logd/viewpetition.php'>viewpetition.php</a></li>
<li><a href='source.php?url=/logd/village.php'>village.php</a></li>
<li><a href='source.php?url=/logd/weaponeditor.php'>weaponeditor.php</a></li>
<li><a href='source.php?url=/logd/weapons.php'>weapons.php</a></li>
<li><a href='source.php?url=/logd/special/audrey.php'>special/audrey.php</a></li>
<li><a href='source.php?url=/logd/special/darkhorse.php'>special/darkhorse.php</a></li>
<li><a href='source.php?url=/logd/special/distress.php'>special/distress.php</a></li>
<li><a href='source.php?url=/logd/special/fairy1.php'>special/fairy1.php</a></li>
<li><a href='source.php?url=/logd/special/findgem.php'>special/findgem.php</a></li>
<li><a href='source.php?url=/logd/special/findgold.php'>special/findgold.php</a></li>
<li><a href='source.php?url=/logd/special/glowingstream.php'>special/glowingstream.php</a></li>
<li><a href='source.php?url=/logd/special/grassyfield.php'>special/grassyfield.php</a></li>
<li><a href='source.php?url=/logd/special/oldmanbet.php'>special/oldmanbet.php</a></li>
<li><a href='source.php?url=/logd/special/oldmanpretty.php'>special/oldmanpretty.php</a></li>
<li><a href='source.php?url=/logd/special/oldmantown.php'>special/oldmantown.php</a></li>
<li><a href='source.php?url=/logd/special/oldmanugly.php'>special/oldmanugly.php</a></li>
<li><a href='source.php?url=/logd/special/riddles.php'>special/riddles.php</a></li>
<li><a href='source.php?url=/logd/special/skillmaster.php'>special/skillmaster.php</a></li>
</ul><h1><a name='source'>Source of: /logd/pvp.php</a></h1><code><font color="#000000">
<font color="#0000BB">&lt;?<br /></font><font color="#007700">require_once </font><font color="#DD0000">"common.php"</font><font color="#007700">;<br /></font><font color="#0000BB">$pvptime </font><font color="#007700">= </font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"pvptimeout"</font><font color="#007700">,</font><font color="#0000BB">600</font><font color="#007700">);<br /></font><font color="#0000BB">$pvptimeout </font><font color="#007700">= </font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">"Y-m-d H:i:s"</font><font color="#007700">,</font><font color="#0000BB">strtotime</font><font color="#007700">(</font><font color="#DD0000">"-$pvptime seconds"</font><font color="#007700">));<br /></font><font color="#0000BB">page_header</font><font color="#007700">(</font><font color="#DD0000">"PvP Combat!"</font><font color="#007700">);<br />if (</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"" </font><font color="#007700">&amp;&amp; </font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">act</font><font color="#007700">]!=</font><font color="#DD0000">"attack"</font><font color="#007700">){<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`4You head out to the fields, where you know some unwitting warriors are sleeping.`n`nYou have `^"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">playerfights</font><font color="#007700">].</font><font color="#DD0000">"`4 PvP fights left for today."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"List Warriors"</font><font color="#007700">,</font><font color="#DD0000">"pvp.php?op=list"</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Return to the Village"</font><font color="#007700">,</font><font color="#DD0000">"village.php"</font><font color="#007700">);<br />}else if (</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"list"</font><font color="#007700">){<br />&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"SELECT name,alive,location,sex,level,laston,loggedin,login,pvpflag FROM accounts WHERE <br />&nbsp;&nbsp;&nbsp;&nbsp;(locked=0) AND <br />&nbsp;&nbsp;&nbsp;&nbsp;(level &gt;= "</font><font color="#007700">.(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">level</font><font color="#007700">]-</font><font color="#0000BB">1</font><font color="#007700">).</font><font color="#DD0000">" AND level &lt;= "</font><font color="#007700">.(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">level</font><font color="#007700">]+</font><font color="#0000BB">2</font><font color="#007700">).</font><font color="#DD0000">") AND <br />&nbsp;&nbsp;&nbsp;&nbsp;(alive=1 AND location=0) AND <br />&nbsp;&nbsp;&nbsp;&nbsp;(laston &lt; '"</font><font color="#007700">.</font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">"Y-m-d H:i:s"</font><font color="#007700">,</font><font color="#0000BB">strtotime</font><font color="#007700">(</font><font color="#DD0000">"-"</font><font color="#007700">.</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"LOGINTIMEOUT"</font><font color="#007700">,</font><font color="#0000BB">900</font><font color="#007700">).</font><font color="#DD0000">" sec"</font><font color="#007700">)).</font><font color="#DD0000">"' OR loggedin=0) AND<br />&nbsp;&nbsp;&nbsp;&nbsp;(acctid &lt;&gt; "</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">acctid</font><font color="#007700">].</font><font color="#DD0000">")<br />&nbsp;&nbsp;&nbsp;&nbsp;ORDER BY level DESC"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">//echo ("&lt;pre&gt;$sql&lt;/pre&gt;");<br />&nbsp;&nbsp;</font><font color="#0000BB">$result </font><font color="#007700">= </font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">) or die(</font><font color="#0000BB">db_error</font><font color="#007700">(</font><font color="#0000BB">LINK</font><font color="#007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;table border=0 cellpadding=0&gt;&lt;tr&gt;&lt;td&gt;Name&lt;/td&gt;&lt;td&gt;Level&lt;/td&gt;&lt;/tr&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;for (</font><font color="#0000BB">$i</font><font color="#007700">=</font><font color="#0000BB">0</font><font color="#007700">;</font><font color="#0000BB">$i</font><font color="#007700">&lt;</font><font color="#0000BB">db_num_rows</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);</font><font color="#0000BB">$i</font><font color="#007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">db_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">pvpflag</font><font color="#007700">]&gt;</font><font color="#0000BB">$pvptimeout</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;tr class='"</font><font color="#007700">.(</font><font color="#0000BB">$i</font><font color="#007700">%</font><font color="#0000BB">2</font><font color="#007700">?</font><font color="#DD0000">"trlight"</font><font color="#007700">:</font><font color="#DD0000">"trdark"</font><font color="#007700">).</font><font color="#DD0000">"'&gt;&lt;td&gt;$row</font><font color="#007700">[</font><font color="#DD0000">name</font><font color="#007700">]</font><font color="#DD0000">&lt;/td&gt;&lt;td&gt;$row</font><font color="#007700">[</font><font color="#DD0000">level</font><font color="#007700">]</font><font color="#DD0000">&lt;/td&gt;&lt;td&gt;`i(Attacked too recently)`i&lt;/td&gt;&lt;/tr&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;tr class='"</font><font color="#007700">.(</font><font color="#0000BB">$i</font><font color="#007700">%</font><font color="#0000BB">2</font><font color="#007700">?</font><font color="#DD0000">"trlight"</font><font color="#007700">:</font><font color="#DD0000">"trdark"</font><font color="#007700">).</font><font color="#DD0000">"'&gt;&lt;td&gt;&lt;a href='pvp.php?act=attack&amp;name=$row</font><font color="#007700">[</font><font color="#DD0000">login</font><font color="#007700">]</font><font color="#DD0000">'&gt;$row</font><font color="#007700">[</font><font color="#DD0000">name</font><font color="#007700">]</font><font color="#DD0000">&lt;/a&gt;&lt;/td&gt;&lt;td&gt;$row</font><font color="#007700">[</font><font color="#DD0000">level</font><font color="#007700">]</font><font color="#DD0000">&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"pvp.php?act=attack&amp;name=$row</font><font color="#007700">[</font><font color="#DD0000">login</font><font color="#007700">]</font><font color="#DD0000">"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;/table&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"List Warriors"</font><font color="#007700">,</font><font color="#DD0000">"pvp.php?op=list"</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Return to the Village"</font><font color="#007700">,</font><font color="#DD0000">"village.php"</font><font color="#007700">);<br />} else if (</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">act</font><font color="#007700">] == </font><font color="#DD0000">"attack"</font><font color="#007700">) {<br />&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"SELECT name AS creaturename,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;level AS creaturelevel,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; weapon AS creatureweapon,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gold AS creaturegold,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; experience/10 AS creatureexp,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maxhitpoints AS creaturehealth,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; attack AS creatureattack,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; defence AS creaturedefense,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loggedin,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; laston,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alive,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; acctid,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pvpflag<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM accounts<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE login=</font><font color="#007700">\"</font><font color="#DD0000">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#DD0000">name</font><font color="#007700">]\"</font><font color="#DD0000">"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$result </font><font color="#007700">= </font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">) or die(</font><font color="#0000BB">db_error</font><font color="#007700">(</font><font color="#0000BB">LINK</font><font color="#007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">db_num_rows</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">)&gt;</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">db_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">abs</font><font color="#007700">(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">level</font><font color="#007700">]-</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">creaturelevel</font><font color="#007700">])&gt;</font><font color="#0000BB">2</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`\$Error:`4 That user is out of your level range!"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}elseif (</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">pvpflag</font><font color="#007700">] &gt; </font><font color="#0000BB">$pvptimeout</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`</font><font color="#007700">\$</font><font color="#DD0000">Oops:`4 That user is currently engaged by someone else, you'll have to wait your turn! $row</font><font color="#007700">[</font><font color="#DD0000">pvpflag</font><font color="#007700">]</font><font color="#DD0000"> : $pvptimeout"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">strtotime</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">laston</font><font color="#007700">]) &gt; </font><font color="#0000BB">strtotime</font><font color="#007700">(</font><font color="#DD0000">"-"</font><font color="#007700">.</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"LOGINTIMEOUT"</font><font color="#007700">,</font><font color="#0000BB">900</font><font color="#007700">).</font><font color="#DD0000">" sec"</font><font color="#007700">) &amp;&amp; </font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">loggedin</font><font color="#007700">]){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`\$Error:`4 That user is now online."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((int)</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">location</font><font color="#007700">]!=</font><font color="#0000BB">0 </font><font color="#007700">&amp;&amp; </font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`\$Error:`4 That user is not in a location that you can attack them."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((int)</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">alive</font><font color="#007700">]!=</font><font color="#0000BB">1</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`\$Error:`4 That user is not alive."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">playerfights</font><font color="#007700">]&gt;</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"UPDATE accounts SET pvpflag=now() WHERE acctid=$row</font><font color="#007700">[</font><font color="#DD0000">acctid</font><font color="#007700">]</font><font color="#DD0000">"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$battle</font><font color="#007700">=</font><font color="#0000BB">true</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">pvp</font><font color="#007700">]=</font><font color="#0000BB">1</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">creatureexp</font><font color="#007700">] = </font><font color="#0000BB">round</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">creatureexp</font><font color="#007700">],</font><font color="#0000BB">0</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">badguy</font><font color="#007700">]=</font><font color="#0000BB">createstring</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">playerfights</font><font color="#007700">]--;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`4Judging by how tired you are, you think you had best not engage in another player battle today."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`\$Error:`4 That user was not found!&nbsp;&nbsp;How'd you get here anyhow?"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;if (</font><font color="#0000BB">$battle</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Return to the village"</font><font color="#007700">,</font><font color="#DD0000">"village.php"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br />if (</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"run"</font><font color="#007700">){<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"Your honor prevents you from running"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]=</font><font color="#DD0000">"fight"</font><font color="#007700">;<br />}<br />if (</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">skill</font><font color="#007700">]!=</font><font color="#DD0000">""</font><font color="#007700">){<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"Your honor prevents you from using a special ability"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">skill</font><font color="#007700">]=</font><font color="#DD0000">""</font><font color="#007700">;<br />}<br />if (</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"fight" </font><font color="#007700">|| </font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"run"</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$battle</font><font color="#007700">=</font><font color="#0000BB">true</font><font color="#007700">;<br />}<br />if (</font><font color="#0000BB">$battle</font><font color="#007700">){<br />&nbsp;&nbsp;include(</font><font color="#DD0000">"battle.php"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$victory</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">//$badguy[creaturegold]=e_rand(0,$badguy[creaturegold]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$expbonus </font><font color="#007700">= </font><font color="#0000BB">round</font><font color="#007700">((</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creatureexp</font><font color="#007700">]* (</font><font color="#0000BB">1</font><font color="#007700">+</font><font color="#0000BB">.25</font><font color="#007700">*(</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creaturelevel</font><font color="#007700">]-</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">level</font><font color="#007700">]))) - </font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creatureexp</font><font color="#007700">],</font><font color="#0000BB">0</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`b`&amp;$badguy</font><font color="#007700">[</font><font color="#DD0000">creaturelose</font><font color="#007700">]</font><font color="#DD0000">`0`b`n"</font><font color="#007700">); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`b`</font><font color="#007700">\$</font><font color="#DD0000">You have slain $badguy</font><font color="#007700">[</font><font color="#DD0000">creaturename</font><font color="#007700">]</font><font color="#DD0000">!`0`b`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`#You recieve `^$badguy</font><font color="#007700">[</font><font color="#DD0000">creaturegold</font><font color="#007700">]</font><font color="#DD0000">`# gold!`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$expbonus</font><font color="#007700">&gt;</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`#***Because of the difficult nature of this fight, you are awarded an additional `^$expbonus`# experience!`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if (</font><font color="#0000BB">$expbonus</font><font color="#007700">&lt;</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`#***Because of the simplistic nature of this fight, you are penalized `^$expbonus`# experience!`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"You receive `^"</font><font color="#007700">.(</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creatureexp</font><font color="#007700">]+</font><font color="#0000BB">$expbonus</font><font color="#007700">).</font><font color="#DD0000">"`# experience!`n`0"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'gold'</font><font color="#007700">]+=</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#DD0000">'creaturegold'</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'experience'</font><font color="#007700">]+=(</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#DD0000">'creatureexp'</font><font color="#007700">]+</font><font color="#0000BB">$expbonus</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#DD0000">'location'</font><font color="#007700">]){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnews</font><font color="#007700">(</font><font color="#DD0000">"`4"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'name'</font><font color="#007700">].</font><font color="#DD0000">"`3 defeated `4</font><font color="#007700">{</font><font color="#DD0000">$badguy</font><font color="#007700">[</font><font color="#DD0000">'creaturename'</font><font color="#007700">]}</font><font color="#DD0000">`3 by sneaking in to their room in the inn!"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$killedin</font><font color="#007700">=</font><font color="#DD0000">"`6The Inn"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnews</font><font color="#007700">(</font><font color="#DD0000">"`4"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'name'</font><font color="#007700">].</font><font color="#DD0000">"`3 defeated `4</font><font color="#007700">{</font><font color="#DD0000">$badguy</font><font color="#007700">[</font><font color="#DD0000">'creaturename'</font><font color="#007700">]}</font><font color="#DD0000">`3 in fair combat in the fields."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$killedin</font><font color="#007700">=</font><font color="#DD0000">"`@The Fields"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"SELECT gold FROM accounts WHERE acctid='"</font><font color="#007700">.(int)</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#DD0000">'acctid'</font><font color="#007700">].</font><font color="#DD0000">"'"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$result </font><font color="#007700">= </font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">db_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creaturegold</font><font color="#007700">]=((int)</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">gold</font><font color="#007700">]&gt;(int)</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creaturegold</font><font color="#007700">]?(int)</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creaturegold</font><font color="#007700">]:(int)</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">gold</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">//$sql = "UPDATE accounts SET alive=0, killedin='$killedin', goldinbank=goldinbank-IF(gold&lt;$badguy[creaturegold],gold-$badguy[creaturegold],0),gold=gold-$badguy[creaturegold], experience=experience*.95, slainby=\"".addslashes($session[user][name])."\" WHERE acctid=$badguy[acctid]";<br />// \/- Gunnar Kreitz<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$mailmessage </font><font color="#007700">= </font><font color="#DD0000">"`^"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'name'</font><font color="#007700">].</font><font color="#DD0000">"`2 attacked you in $killedin`2 with %p `^"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'weapon'</font><font color="#007700">].</font><font color="#DD0000">"`2, and defeated you!"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">.</font><font color="#DD0000">" `n`nYou noticed %o had a maximum hp of `^"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'maxhitpoints'</font><font color="#007700">].</font><font color="#DD0000">"`2 and just before you died %o had `^"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'hitpoints'</font><font color="#007700">].</font><font color="#DD0000">"`2 remaining."<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">.</font><font color="#DD0000">" `n`nAs a result, you lost `\$5%`2 of your experience, and `^"</font><font color="#007700">.</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creaturegold</font><font color="#007700">].</font><font color="#DD0000">"`2 gold."<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">.</font><font color="#DD0000">" `n`nDon't you think it's time for some revenge?"</font><font color="#007700">;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$mailmessage </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"%p"</font><font color="#007700">,(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'sex'</font><font color="#007700">]?</font><font color="#DD0000">"her"</font><font color="#007700">:</font><font color="#DD0000">"his"</font><font color="#007700">),</font><font color="#0000BB">$mailmessage</font><font color="#007700">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$mailmessage </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"%o"</font><font color="#007700">,(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'sex'</font><font color="#007700">]?</font><font color="#DD0000">"she"</font><font color="#007700">:</font><font color="#DD0000">"he"</font><font color="#007700">),</font><font color="#0000BB">$mailmessage</font><font color="#007700">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">systemmail</font><font color="#007700">(</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#DD0000">'acctid'</font><font color="#007700">],</font><font color="#DD0000">"`2You were killed in $killedin`2"</font><font color="#007700">,</font><font color="#0000BB">$mailmessage</font><font color="#007700">); <br /></font><font color="#FF8000">// /\- Gunnar Kreitz<br /><br />// \/- Eric Stevens<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//systemmail($badguy[acctid],"`2You were killed in $killedin`2","`^".$session[user][name]."`2 attacked you in $killedin`2, and defeated you!`n`nAs a result, you lost `\$5%`2 of your experience, and `^".$badguy[creaturegold]."`2 gold. `n`nDon't you think it's time for some revenge?"); <br />// /\- Eric Stevens<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"UPDATE accounts SET alive=0, goldinbank=goldinbank-IF(gold&lt;$badguy</font><font color="#007700">[</font><font color="#DD0000">creaturegold</font><font color="#007700">]</font><font color="#DD0000">,gold-$badguy</font><font color="#007700">[</font><font color="#DD0000">creaturegold</font><font color="#007700">]</font><font color="#DD0000">,0),gold=gold-$badguy</font><font color="#007700">[</font><font color="#DD0000">creaturegold</font><font color="#007700">]</font><font color="#DD0000">, experience=experience*.95 WHERE acctid="</font><font color="#007700">.(int)</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">acctid</font><font color="#007700">].</font><font color="#DD0000">""</font><font color="#007700">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]=</font><font color="#DD0000">""</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Return to the village"</font><font color="#007700">,</font><font color="#DD0000">"village.php"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$badguy</font><font color="#007700">=array();<br />&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</font><font color="#0000BB">$defeat</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Daily news"</font><font color="#007700">,</font><font color="#DD0000">"news.php"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"SELECT taunt FROM taunts ORDER BY rand("</font><font color="#007700">.</font><font color="#0000BB">e_rand</font><font color="#007700">().</font><font color="#DD0000">") LIMIT 1"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$result </font><font color="#007700">= </font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">) or die(</font><font color="#0000BB">db_error</font><font color="#007700">(</font><font color="#0000BB">LINK</font><font color="#007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$taunt </font><font color="#007700">= </font><font color="#0000BB">db_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$taunt </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"%s"</font><font color="#007700">,(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">sex</font><font color="#007700">]?</font><font color="#DD0000">"her"</font><font color="#007700">:</font><font color="#DD0000">"him"</font><font color="#007700">),</font><font color="#0000BB">$taunt</font><font color="#007700">[</font><font color="#0000BB">taunt</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$taunt </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"%o"</font><font color="#007700">,(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">sex</font><font color="#007700">]?</font><font color="#DD0000">"she"</font><font color="#007700">:</font><font color="#DD0000">"he"</font><font color="#007700">),</font><font color="#0000BB">$taunt</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$taunt </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"%p"</font><font color="#007700">,(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">sex</font><font color="#007700">]?</font><font color="#DD0000">"her"</font><font color="#007700">:</font><font color="#DD0000">"his"</font><font color="#007700">),</font><font color="#0000BB">$taunt</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$taunt </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"%x"</font><font color="#007700">,(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">weapon</font><font color="#007700">]),</font><font color="#0000BB">$taunt</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$taunt </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"%X"</font><font color="#007700">,</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creatureweapon</font><font color="#007700">],</font><font color="#0000BB">$taunt</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$taunt </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"%W"</font><font color="#007700">,</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creaturename</font><font color="#007700">],</font><font color="#0000BB">$taunt</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$taunt </font><font color="#007700">= </font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"%w"</font><font color="#007700">,</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">name</font><font color="#007700">],</font><font color="#0000BB">$taunt</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">location</font><font color="#007700">]){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$killedin</font><font color="#007700">=</font><font color="#DD0000">"`6The Inn"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$killedin</font><font color="#007700">=</font><font color="#DD0000">"`@The Fields"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">acctid</font><font color="#007700">]=(int)</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">acctid</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creaturegold</font><font color="#007700">]=(int)</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">creaturegold</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">systemmail</font><font color="#007700">(</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">acctid</font><font color="#007700">],</font><font color="#DD0000">"`2You were successful in $killedin`2"</font><font color="#007700">,</font><font color="#DD0000">"`^"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">name</font><font color="#007700">].</font><font color="#DD0000">"`2 attacked you in $killedin`2, but you were victorious!`n`nAs a result, you recieved `^"</font><font color="#007700">.</font><font color="#0000BB">round</font><font color="#007700">(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">experience</font><font color="#007700">]*</font><font color="#0000BB">0.1</font><font color="#007700">,</font><font color="#0000BB">0</font><font color="#007700">).</font><font color="#DD0000">"`2 experience and `^"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">].</font><font color="#DD0000">"`2 gold!"</font><font color="#007700">); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnews</font><font color="#007700">(</font><font color="#DD0000">"`%"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">name</font><font color="#007700">].</font><font color="#DD0000">"`5 has been slain when "</font><font color="#007700">.(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">sex</font><font color="#007700">]?</font><font color="#DD0000">"she"</font><font color="#007700">:</font><font color="#DD0000">"he"</font><font color="#007700">).</font><font color="#DD0000">" attacked $badguy</font><font color="#007700">[</font><font color="#DD0000">creaturename</font><font color="#007700">]</font><font color="#DD0000"> in $killedin`5.`n$taunt"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"UPDATE accounts SET gold=gold+"</font><font color="#007700">.(int)</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">].</font><font color="#DD0000">", experience=experience+"</font><font color="#007700">.</font><font color="#0000BB">round</font><font color="#007700">(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">experience</font><font color="#007700">]*</font><font color="#0000BB">0.1</font><font color="#007700">,</font><font color="#0000BB">0</font><font color="#007700">).</font><font color="#DD0000">" WHERE acctid="</font><font color="#007700">.(int)</font><font color="#0000BB">$badguy</font><font color="#007700">[</font><font color="#0000BB">acctid</font><font color="#007700">].</font><font color="#DD0000">""</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">alive</font><font color="#007700">]=</font><font color="#0000BB">false</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]=</font><font color="#0000BB">0</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">hitpoints</font><font color="#007700">]=</font><font color="#0000BB">0</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">experience</font><font color="#007700">]=</font><font color="#0000BB">round</font><font color="#007700">(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">experience</font><font color="#007700">]*</font><font color="#0000BB">.85</font><font color="#007700">,</font><font color="#0000BB">0</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">badguy</font><font color="#007700">]=</font><font color="#DD0000">""</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`b`&amp;You have been slain by `%$badguy</font><font color="#007700">[</font><font color="#DD0000">creaturename</font><font color="#007700">]</font><font color="#DD0000">`&amp;!!!`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`4All gold on hand has been lost!`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`415% of experience has been lost!`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"You may begin fighting again tomorrow."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">page_footer</font><font color="#007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">fightnav</font><font color="#007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></font><font color="#0000BB">page_footer</font><font color="#007700">();<br /></font><font color="#0000BB">?&gt;<br /></font>
</font>
</code>