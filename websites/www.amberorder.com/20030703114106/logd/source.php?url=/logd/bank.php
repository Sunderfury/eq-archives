<h1>View Source: /logd/bank.php</h1><a href='#source'>Click here for the source,</a> OR<br><b>Other files that you may wish to view the source of:</b><ul><li><a href='source.php?url=/logd/about.php'>about.php</a></li>
<li><a href='source.php?url=/logd/armor.php'>armor.php</a></li>
<li><a href='source.php?url=/logd/armoreditor.php'>armoreditor.php</a></li>
<li><a href='source.php?url=/logd/badnav.php'>badnav.php</a></li>
<li><a href='source.php?url=/logd/bank.php'>bank.php</a></li>
<li><a href='source.php?url=/logd/battle.php'>battle.php</a></li>
<li><a href='source.php?url=/logd/bio.php'>bio.php</a></li>
<li><a href='source.php?url=/logd/common.php'>common.php</a></li>
<li><a href='source.php?url=/logd/configuration.php'>configuration.php</a></li>
<li><a href='source.php?url=/logd/connector.php'>connector.php</a></li>
<li><a href='source.php?url=/logd/create.php'>create.php</a></li>
<li><a href='source.php?url=/logd/creatures.php'>creatures.php</a></li>
<li>dbconnect.php &#151; this file cannot be viewed: it contains sensitive information specific to this installation.</li>
<li><a href='source.php?url=/logd/dbwrapper.php'>dbwrapper.php</a></li>
<li><a href='source.php?url=/logd/donators.php'>donators.php</a></li>
<li>dragon.php &#151; this file cannot be viewed: If you want to read the dragon script, I suggest you do so by defeating it!</li>
<li><a href='source.php?url=/logd/forest.php'>forest.php</a></li>
<li><a href='source.php?url=/logd/graveyard.php'>graveyard.php</a></li>
<li><a href='source.php?url=/logd/gypsy.php'>gypsy.php</a></li>
<li><a href='source.php?url=/logd/healer.php'>healer.php</a></li>
<li><a href='source.php?url=/logd/hof.php'>hof.php</a></li>
<li><a href='source.php?url=/logd/index.php'>index.php</a></li>
<li><a href='source.php?url=/logd/inn.php'>inn.php</a></li>
<li><a href='source.php?url=/logd/list.php'>list.php</a></li>
<li><a href='source.php?url=/logd/logdnet.php'>logdnet.php</a></li>
<li><a href='source.php?url=/logd/login.php'>login.php</a></li>
<li><a href='source.php?url=/logd/mail.php'>mail.php</a></li>
<li><a href='source.php?url=/logd/motd.php'>motd.php</a></li>
<li><a href='source.php?url=/logd/newday.php'>newday.php</a></li>
<li><a href='source.php?url=/logd/news.php'>news.php</a></li>
<li><a href='source.php?url=/logd/petition.php'>petition.php</a></li>
<li><a href='source.php?url=/logd/prefs.php'>prefs.php</a></li>
<li><a href='source.php?url=/logd/pvp.php'>pvp.php</a></li>
<li><a href='source.php?url=/logd/referers.php'>referers.php</a></li>
<li><a href='source.php?url=/logd/shades.php'>shades.php</a></li>
<li><a href='source.php?url=/logd/source.php'>source.php</a></li>
<li><a href='source.php?url=/logd/stables.php'>stables.php</a></li>
<li><a href='source.php?url=/logd/stats.php'>stats.php</a></li>
<li><a href='source.php?url=/logd/superuser.php'>superuser.php</a></li>
<li><a href='source.php?url=/logd/taunt.php'>taunt.php</a></li>
<li><a href='source.php?url=/logd/train.php'>train.php</a></li>
<li><a href='source.php?url=/logd/translator.php'>translator.php</a></li>
<li><a href='source.php?url=/logd/translator_de.php'>translator_de.php</a></li>
<li><a href='source.php?url=/logd/translator_dk.php'>translator_dk.php</a></li>
<li><a href='source.php?url=/logd/translator_en.php'>translator_en.php</a></li>
<li><a href='source.php?url=/logd/translator_es.php'>translator_es.php</a></li>
<li><a href='source.php?url=/logd/translator_fr.php'>translator_fr.php</a></li>
<li><a href='source.php?url=/logd/user.php'>user.php</a></li>
<li><a href='source.php?url=/logd/viewpetition.php'>viewpetition.php</a></li>
<li><a href='source.php?url=/logd/village.php'>village.php</a></li>
<li><a href='source.php?url=/logd/weaponeditor.php'>weaponeditor.php</a></li>
<li><a href='source.php?url=/logd/weapons.php'>weapons.php</a></li>
<li><a href='source.php?url=/logd/special/audrey.php'>special/audrey.php</a></li>
<li><a href='source.php?url=/logd/special/darkhorse.php'>special/darkhorse.php</a></li>
<li><a href='source.php?url=/logd/special/distress.php'>special/distress.php</a></li>
<li><a href='source.php?url=/logd/special/fairy1.php'>special/fairy1.php</a></li>
<li><a href='source.php?url=/logd/special/findgem.php'>special/findgem.php</a></li>
<li><a href='source.php?url=/logd/special/findgold.php'>special/findgold.php</a></li>
<li><a href='source.php?url=/logd/special/glowingstream.php'>special/glowingstream.php</a></li>
<li><a href='source.php?url=/logd/special/grassyfield.php'>special/grassyfield.php</a></li>
<li><a href='source.php?url=/logd/special/oldmanbet.php'>special/oldmanbet.php</a></li>
<li><a href='source.php?url=/logd/special/oldmanpretty.php'>special/oldmanpretty.php</a></li>
<li><a href='source.php?url=/logd/special/oldmantown.php'>special/oldmantown.php</a></li>
<li><a href='source.php?url=/logd/special/oldmanugly.php'>special/oldmanugly.php</a></li>
<li><a href='source.php?url=/logd/special/riddles.php'>special/riddles.php</a></li>
<li><a href='source.php?url=/logd/special/skillmaster.php'>special/skillmaster.php</a></li>
</ul><h1><a name='source'>Source of: /logd/bank.php</a></h1><code><font color="#000000">
<font color="#0000BB">&lt;?<br /></font><font color="#007700">require_once </font><font color="#DD0000">"common.php"</font><font color="#007700">;<br /></font><font color="#0000BB">page_header</font><font color="#007700">(</font><font color="#DD0000">"Ye Olde Bank"</font><font color="#007700">);<br /></font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`^`c`bYe Olde Bank`b`c`6"</font><font color="#007700">);<br />if (</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">""</font><font color="#007700">){<br />&nbsp;&nbsp;</font><font color="#0000BB">checkday</font><font color="#007700">();<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"A short man in a immaculately arranged suit greets you from behind reading spectacles.`n`n"</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"\"`5Hello my good man,`6\" you greet him, \"`5Might I inquire as to my balance this fine day?`6\"`n`n"</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"The banker mumbles, \"`3Hmm, "</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">name</font><font color="#007700">].</font><font color="#DD0000">"`3, let's see.....`6\" as he scans down a page "</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"in his ledger.&nbsp;&nbsp;"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]&gt;=</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"\"`3Aah, yes, here we are.&nbsp;&nbsp;You have `^"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">].</font><font color="#DD0000">" gold`3 in our "</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"prestigious bank.&nbsp;&nbsp;Is there anything else I can do for you?`6\""</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"\"`3Aah, yes, here we are.&nbsp;&nbsp;You have a `&amp;debt`3 of `^"</font><font color="#007700">.</font><font color="#0000BB">abs</font><font color="#007700">(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]).</font><font color="#DD0000">" gold`3 in our "</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"prestigious bank.&nbsp;&nbsp;Is there anything else I can do for you?`6\""</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}else if(</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#DD0000">'op'</font><font color="#007700">]==</font><font color="#DD0000">"transfer"</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6`bTransfer Money`b:`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]&gt;=</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"You can only transfer `^"</font><font color="#007700">.</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"transferperlevel"</font><font color="#007700">,</font><font color="#0000BB">25</font><font color="#007700">).</font><font color="#DD0000">"`6 gold per the recipient's level.`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;form action='bank.php?op=transfer2' method='POST'&gt;Transfer &lt;u&gt;h&lt;/u&gt;ow much: &lt;input name='amount' id='amount' accesskey='h' width='5'&gt;`n"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"T&lt;u&gt;o&lt;/u&gt;: &lt;input name='to' accesskey='o'&gt; (partial names are ok, you will be asked to confirm the transaction before it occurs).`n"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;input type='submit' value='Preview Transfer'&gt;&lt;/form&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;script language='javascript'&gt;document.getElementById('amount').focus();&lt;/script&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=transfer2"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6The little old banker tells you that he refuses to transfer money for someone who is in debt."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}else if(</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#DD0000">'op'</font><font color="#007700">]==</font><font color="#DD0000">"transfer2"</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6`bConfirm Transfer`b:`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$string</font><font color="#007700">=</font><font color="#DD0000">"%"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;for (</font><font color="#0000BB">$x</font><font color="#007700">=</font><font color="#0000BB">0</font><font color="#007700">;</font><font color="#0000BB">$x</font><font color="#007700">&lt;</font><font color="#0000BB">strlen</font><font color="#007700">(</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#DD0000">'to'</font><font color="#007700">]);</font><font color="#0000BB">$x</font><font color="#007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$string </font><font color="#007700">.= </font><font color="#0000BB">substr</font><font color="#007700">(</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#DD0000">'to'</font><font color="#007700">],</font><font color="#0000BB">$x</font><font color="#007700">,</font><font color="#0000BB">1</font><font color="#007700">).</font><font color="#DD0000">"%"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"SELECT name,login FROM accounts WHERE name LIKE '"</font><font color="#007700">.</font><font color="#0000BB">addslashes</font><font color="#007700">(</font><font color="#0000BB">$string</font><font color="#007700">).</font><font color="#DD0000">"'"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$result </font><font color="#007700">= </font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$amt </font><font color="#007700">= </font><font color="#0000BB">abs</font><font color="#007700">((int)</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#DD0000">'amount'</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">db_num_rows</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">)==</font><font color="#0000BB">1</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">db_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;form action='bank.php?op=transfer3' method='POST'&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6Transfer `^$amt`6 to `&amp;$row</font><font color="#007700">[</font><font color="#DD0000">name</font><font color="#007700">]</font><font color="#DD0000">`6."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;input type='hidden' name='to' value='"</font><font color="#007700">.</font><font color="#0000BB">HTMLEntities</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'login'</font><font color="#007700">]).</font><font color="#DD0000">"'&gt;&lt;input type='hidden' name='amount' value='$amt'&gt;&lt;input type='submit' value='Complete Transfer'&gt;&lt;/form&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=transfer3"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}elseif(</font><font color="#0000BB">db_num_rows</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">)&gt;</font><font color="#0000BB">1</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;form action='bank.php?op=transfer3' method='POST'&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6Transfer `^$amt`6 to &lt;select name='to' class='input'&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (</font><font color="#0000BB">$i</font><font color="#007700">=</font><font color="#0000BB">0</font><font color="#007700">;</font><font color="#0000BB">$i</font><font color="#007700">&lt;</font><font color="#0000BB">db_num_rows</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);</font><font color="#0000BB">$i</font><font color="#007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">db_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">//output($row[name]." ".$row[login]."`n");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;option value=\""</font><font color="#007700">.</font><font color="#0000BB">HTMLEntities</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'login'</font><font color="#007700">]).</font><font color="#DD0000">"\"&gt;"</font><font color="#007700">.</font><font color="#0000BB">preg_replace</font><font color="#007700">(</font><font color="#DD0000">"'[`].'"</font><font color="#007700">,</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'name'</font><font color="#007700">]).</font><font color="#DD0000">"&lt;/option&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;/select&gt;&lt;input type='hidden' name='amount' value='$amt'&gt;&lt;input type='submit' value='Complete Transfer'&gt;&lt;/form&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=transfer3"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6No one matching that name could be found!&nbsp;&nbsp;Please try again."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}else if(</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#DD0000">'op'</font><font color="#007700">]==</font><font color="#DD0000">"transfer3"</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$amt </font><font color="#007700">= </font><font color="#0000BB">abs</font><font color="#007700">((int)</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#DD0000">'amount'</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6`bTransfer Completion`b`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]+</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]&lt;</font><font color="#0000BB">$amt</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6How can you transfer `^$amt`6 gold when you only possess "</font><font color="#007700">.(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]+</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]).</font><font color="#DD0000">"`6?"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"SELECT name,acctid,level,transferredtoday FROM accounts WHERE login='</font><font color="#007700">{</font><font color="#DD0000">$_POST</font><font color="#007700">[</font><font color="#DD0000">'to'</font><font color="#007700">]}</font><font color="#DD0000">'"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$result </font><font color="#007700">= </font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">db_num_rows</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">)==</font><font color="#0000BB">1</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">db_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$maxtfer </font><font color="#007700">= </font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'level'</font><font color="#007700">]*</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"transferperlevel"</font><font color="#007700">,</font><font color="#0000BB">25</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$maxtfer</font><font color="#007700">&lt;</font><font color="#0000BB">$amt</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6The transfer was not completed: `&amp;</font><font color="#007700">{</font><font color="#DD0000">$row</font><font color="#007700">[</font><font color="#DD0000">'name'</font><font color="#007700">]}</font><font color="#DD0000">`6 can only receive up to `^$maxtfer`6 gold."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'transferredtoday'</font><font color="#007700">]&gt;=</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"transferreceive"</font><font color="#007700">,</font><font color="#0000BB">3</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`&amp;</font><font color="#007700">{</font><font color="#DD0000">$row</font><font color="#007700">[</font><font color="#DD0000">'name'</font><font color="#007700">]}</font><font color="#DD0000">`6 has received too many transfers today, you will have to wait until tomorrow."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if(</font><font color="#0000BB">$amt</font><font color="#007700">&lt;(int)</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'level'</font><font color="#007700">]){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6You might want to send a worthwhile transfer, at least as much as your level."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else if(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'acctid'</font><font color="#007700">]==</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'acctid'</font><font color="#007700">]){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6You cannot transfer money to yourself!&nbsp;&nbsp;That makes no sense!"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]-=</font><font color="#0000BB">$amt</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]&lt;</font><font color="#0000BB">0</font><font color="#007700">){ </font><font color="#FF8000">//withdraw in case they don't have enough on hand.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]+=</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]=</font><font color="#0000BB">0</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"UPDATE accounts SET goldinbank=goldinbank+$amt,transferredtoday=transferredtoday+1 WHERE acctid='</font><font color="#007700">{</font><font color="#DD0000">$row</font><font color="#007700">[</font><font color="#DD0000">'acctid'</font><font color="#007700">]}</font><font color="#DD0000">'"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6Transfer Completed!"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">systemmail</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'acctid'</font><font color="#007700">],</font><font color="#DD0000">"`^You have received a money transfer!`0"</font><font color="#007700">,</font><font color="#DD0000">"`&amp;</font><font color="#007700">{</font><font color="#DD0000">$session</font><font color="#007700">[</font><font color="#DD0000">'user'</font><font color="#007700">][</font><font color="#DD0000">'name'</font><font color="#007700">]}</font><font color="#DD0000">`6 has transferred `^$amt`6 gold to your bank account!"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6Transfer could not be completed, please try again!"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}else if(</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"deposit"</font><font color="#007700">){<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;form action='bank.php?op=depositfinish' method='POST'&gt;You have "</font><font color="#007700">.(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]&gt;=</font><font color="#0000BB">0</font><font color="#007700">?</font><font color="#DD0000">"a balance of"</font><font color="#007700">:</font><font color="#DD0000">"a debt of"</font><font color="#007700">).</font><font color="#DD0000">" "</font><font color="#007700">.</font><font color="#0000BB">abs</font><font color="#007700">(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]).</font><font color="#DD0000">" gold in the bank.`n"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`^"</font><font color="#007700">.(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]&gt;=</font><font color="#0000BB">0</font><font color="#007700">?</font><font color="#DD0000">"Deposit"</font><font color="#007700">:</font><font color="#DD0000">"Pay off"</font><font color="#007700">).</font><font color="#DD0000">" &lt;u&gt;h&lt;/u&gt;ow much? &lt;input id='input' name='amount' width=5 accesskey='h'&gt; &lt;input type='submit' class='button' value='Deposit'&gt;`n`iEnter 0 or nothing to deposit it all`i&lt;/form&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;script language='javascript'&gt;document.getElementById('input').focus();&lt;/script&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=depositfinish"</font><font color="#007700">);<br />}else if(</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"depositfinish"</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]=</font><font color="#0000BB">abs</font><font color="#007700">((int)</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]==</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]=</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]&gt;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`\$ERROR: Not enough gold in hand to deposit.`^`n`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"You plunk your `&amp;"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">].</font><font color="#DD0000">"`^ gold on the counter and declare that you would like to deposit all `&amp;$_POST</font><font color="#007700">[</font><font color="#DD0000">amount</font><font color="#007700">]</font><font color="#DD0000">`^ gold of it."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`n`nThe little old man stares blankly for a few seconds until you become self conscious and count your money again, realizing your mistake."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`^`bYou deposit `&amp;$_POST</font><font color="#007700">[</font><font color="#DD0000">amount</font><font color="#007700">]</font><font color="#DD0000">`^ gold in to your bank account, "</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]+=</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]-=</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"leaving you with "</font><font color="#007700">.(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]&gt;=</font><font color="#0000BB">0</font><font color="#007700">?</font><font color="#DD0000">"a balance of"</font><font color="#007700">:</font><font color="#DD0000">"a debt of"</font><font color="#007700">).</font><font color="#DD0000">" `&amp;"</font><font color="#007700">.</font><font color="#0000BB">abs</font><font color="#007700">(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]).</font><font color="#DD0000">"`^ gold in your account and `&amp;"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">].</font><font color="#DD0000">"`^ gold in hand.`b"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}else if(</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"borrow"</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$maxborrow </font><font color="#007700">= </font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">level</font><font color="#007700">]*</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"borrowperlevel"</font><font color="#007700">,</font><font color="#0000BB">20</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;form action='bank.php?op=withdrawfinish' method='POST'&gt;You have "</font><font color="#007700">.(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]&gt;=</font><font color="#0000BB">0</font><font color="#007700">?</font><font color="#DD0000">"a balance of"</font><font color="#007700">:</font><font color="#DD0000">"a debt of"</font><font color="#007700">).</font><font color="#DD0000">" "</font><font color="#007700">.</font><font color="#0000BB">abs</font><font color="#007700">(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]).</font><font color="#DD0000">" gold in the bank.`n"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`^Borrow &lt;u&gt;h&lt;/u&gt;ow much (you may borrow a max of $maxborrow total at your level)? &lt;input id='input' name='amount' width=5 accesskey='h'&gt; &lt;input type='submit' class='button' name='borrow' value='Borrow'&gt;`n(Money will be withdrawn until you have none left, the remainder will be borrowed)&lt;/form&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;script language='javascript'&gt;document.getElementById('input').focus();&lt;/script&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=withdrawfinish"</font><font color="#007700">);<br />}else if(</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"withdraw"</font><font color="#007700">){<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;form action='bank.php?op=withdrawfinish' method='POST'&gt;You have "</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">].</font><font color="#DD0000">" gold in the bank.`n"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`^Withdraw &lt;u&gt;h&lt;/u&gt;ow much? &lt;input id='input' name='amount' width=5 accesskey='h'&gt; &lt;input type='submit' class='button' value='Withdraw'&gt;`n`iEnter 0 or nothing to withdraw it all`i&lt;/form&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;script language='javascript'&gt;document.getElementById('input').focus();&lt;/script&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=withdrawfinish"</font><font color="#007700">);<br />}else if(</font><font color="#0000BB">$HTTP_GET_VARS</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"withdrawfinish"</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]=</font><font color="#0000BB">abs</font><font color="#007700">((int)</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]==</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]=</font><font color="#0000BB">abs</font><font color="#007700">(</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]&gt;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">] &amp;&amp; </font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">borrow</font><font color="#007700">]==</font><font color="#DD0000">""</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`\$ERROR: Not enough gold in the bank to to withdraw.`^`n`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"Having been informed that you have `&amp;"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">].</font><font color="#DD0000">"`^ gold in your account, you declare that you would like to withdraw all `&amp;$_POST</font><font color="#007700">[</font><font color="#DD0000">amount</font><font color="#007700">]</font><font color="#DD0000">`^ of it."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`n`nThe little man stares blankly at you for a second, then advises you take basic arithmetic.&nbsp;&nbsp;You realize your folly and think you should try again."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}else if(</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">]&gt;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$lefttoborrow </font><font color="#007700">= </font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$maxborrow </font><font color="#007700">= </font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">level</font><font color="#007700">]*</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"borrowperlevel"</font><font color="#007700">,</font><font color="#0000BB">20</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$lefttoborrow</font><font color="#007700">&lt;=</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]+</font><font color="#0000BB">$maxborrow</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]&gt;</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6You withdraw your remaining `^"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">].</font><font color="#DD0000">"`6 gold, and "</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$lefttoborrow</font><font color="#007700">-=</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]+=</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]=</font><font color="#0000BB">0</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6You "</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$lefttoborrow</font><font color="#007700">-</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">] &gt; </font><font color="#0000BB">$maxborrow</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"ask to borrow `^$lefttoborrow`6 gold.&nbsp;&nbsp;The short little man looks up your account and informs you that you may only borrow up to `^$maxborrow`6 gold."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"borrow `^$lefttoborrow`6 gold."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]-=</font><font color="#0000BB">$lefttoborrow</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]+=</font><font color="#0000BB">$lefttoborrow</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`6Considering the `^</font><font color="#007700">{</font><font color="#DD0000">$session</font><font color="#007700">[</font><font color="#DD0000">user</font><font color="#007700">][</font><font color="#DD0000">goldinbank</font><font color="#007700">]}</font><font color="#DD0000">`6 gold in your account, you ask to borrow `^"</font><font color="#007700">.(</font><font color="#0000BB">$lefttoborrow</font><font color="#007700">-</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]).</font><font color="#DD0000">"`6, but<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the short little man looks up your account and informs you that you may only borrow up to `^$maxborrow`6 gold at your level."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`^`bYou withdraw `&amp;$_POST</font><font color="#007700">[</font><font color="#DD0000">amount</font><font color="#007700">]</font><font color="#DD0000">`^ gold from your bank account, "</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]-=</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">]+=</font><font color="#0000BB">$_POST</font><font color="#007700">[</font><font color="#0000BB">amount</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"leaving you with `&amp;"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">].</font><font color="#DD0000">"`^ gold in your account and `&amp;"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">gold</font><font color="#007700">].</font><font color="#DD0000">"`^ gold in hand.`b"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Return to the Village"</font><font color="#007700">,</font><font color="#DD0000">"village.php"</font><font color="#007700">);<br />if (</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">goldinbank</font><font color="#007700">]&gt;=</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Withdraw"</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=withdraw"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Deposit"</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=deposit"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"borrowperlevel"</font><font color="#007700">,</font><font color="#0000BB">20</font><font color="#007700">)) </font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Take out a loan"</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=borrow"</font><font color="#007700">);<br />}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Pay off debt"</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=deposit"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"borrowperlevel"</font><font color="#007700">,</font><font color="#0000BB">20</font><font color="#007700">)) </font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Borrow More"</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=borrow"</font><font color="#007700">);<br />}<br />if (</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"allowgoldtransfer"</font><font color="#007700">,</font><font color="#0000BB">1</font><font color="#007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">level</font><font color="#007700">]&gt;=</font><font color="#0000BB">getsetting</font><font color="#007700">(</font><font color="#DD0000">"mintransferlev"</font><font color="#007700">,</font><font color="#0000BB">3</font><font color="#007700">) || </font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">dragonkills</font><font color="#007700">]&gt;</font><font color="#0000BB">0</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Transfer Money"</font><font color="#007700">,</font><font color="#DD0000">"bank.php?op=transfer"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></font><font color="#0000BB">page_footer</font><font color="#007700">();<br /><br /></font><font color="#0000BB">?&gt;</font>
</font>
</code>