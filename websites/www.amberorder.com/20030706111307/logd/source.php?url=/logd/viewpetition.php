<h1>View Source: /logd/viewpetition.php</h1><a href='#source'>Click here for the source,</a> OR<br><b>Other files that you may wish to view the source of:</b><ul><li><a href='source.php?url=/logd/about.php'>about.php</a></li>
<li><a href='source.php?url=/logd/armor.php'>armor.php</a></li>
<li><a href='source.php?url=/logd/armoreditor.php'>armoreditor.php</a></li>
<li><a href='source.php?url=/logd/badnav.php'>badnav.php</a></li>
<li><a href='source.php?url=/logd/bank.php'>bank.php</a></li>
<li><a href='source.php?url=/logd/battle.php'>battle.php</a></li>
<li><a href='source.php?url=/logd/bio.php'>bio.php</a></li>
<li><a href='source.php?url=/logd/common.php'>common.php</a></li>
<li><a href='source.php?url=/logd/configuration.php'>configuration.php</a></li>
<li><a href='source.php?url=/logd/connector.php'>connector.php</a></li>
<li><a href='source.php?url=/logd/create.php'>create.php</a></li>
<li><a href='source.php?url=/logd/creatures.php'>creatures.php</a></li>
<li>dbconnect.php &#151; this file cannot be viewed: it contains sensitive information specific to this installation.</li>
<li><a href='source.php?url=/logd/dbwrapper.php'>dbwrapper.php</a></li>
<li><a href='source.php?url=/logd/donators.php'>donators.php</a></li>
<li>dragon.php &#151; this file cannot be viewed: If you want to read the dragon script, I suggest you do so by defeating it!</li>
<li><a href='source.php?url=/logd/forest.php'>forest.php</a></li>
<li><a href='source.php?url=/logd/graveyard.php'>graveyard.php</a></li>
<li><a href='source.php?url=/logd/gypsy.php'>gypsy.php</a></li>
<li><a href='source.php?url=/logd/healer.php'>healer.php</a></li>
<li><a href='source.php?url=/logd/hof.php'>hof.php</a></li>
<li><a href='source.php?url=/logd/index.php'>index.php</a></li>
<li><a href='source.php?url=/logd/inn.php'>inn.php</a></li>
<li><a href='source.php?url=/logd/list.php'>list.php</a></li>
<li><a href='source.php?url=/logd/logdnet.php'>logdnet.php</a></li>
<li><a href='source.php?url=/logd/login.php'>login.php</a></li>
<li><a href='source.php?url=/logd/mail.php'>mail.php</a></li>
<li><a href='source.php?url=/logd/motd.php'>motd.php</a></li>
<li><a href='source.php?url=/logd/newday.php'>newday.php</a></li>
<li><a href='source.php?url=/logd/news.php'>news.php</a></li>
<li><a href='source.php?url=/logd/petition.php'>petition.php</a></li>
<li><a href='source.php?url=/logd/prefs.php'>prefs.php</a></li>
<li><a href='source.php?url=/logd/pvp.php'>pvp.php</a></li>
<li><a href='source.php?url=/logd/referers.php'>referers.php</a></li>
<li><a href='source.php?url=/logd/shades.php'>shades.php</a></li>
<li><a href='source.php?url=/logd/source.php'>source.php</a></li>
<li><a href='source.php?url=/logd/stables.php'>stables.php</a></li>
<li><a href='source.php?url=/logd/stats.php'>stats.php</a></li>
<li><a href='source.php?url=/logd/superuser.php'>superuser.php</a></li>
<li><a href='source.php?url=/logd/taunt.php'>taunt.php</a></li>
<li><a href='source.php?url=/logd/train.php'>train.php</a></li>
<li><a href='source.php?url=/logd/translator.php'>translator.php</a></li>
<li><a href='source.php?url=/logd/translator_de.php'>translator_de.php</a></li>
<li><a href='source.php?url=/logd/translator_dk.php'>translator_dk.php</a></li>
<li><a href='source.php?url=/logd/translator_en.php'>translator_en.php</a></li>
<li><a href='source.php?url=/logd/translator_es.php'>translator_es.php</a></li>
<li><a href='source.php?url=/logd/translator_fr.php'>translator_fr.php</a></li>
<li><a href='source.php?url=/logd/user.php'>user.php</a></li>
<li><a href='source.php?url=/logd/viewpetition.php'>viewpetition.php</a></li>
<li><a href='source.php?url=/logd/village.php'>village.php</a></li>
<li><a href='source.php?url=/logd/weaponeditor.php'>weaponeditor.php</a></li>
<li><a href='source.php?url=/logd/weapons.php'>weapons.php</a></li>
<li><a href='source.php?url=/logd/special/audrey.php'>special/audrey.php</a></li>
<li><a href='source.php?url=/logd/special/darkhorse.php'>special/darkhorse.php</a></li>
<li><a href='source.php?url=/logd/special/distress.php'>special/distress.php</a></li>
<li><a href='source.php?url=/logd/special/fairy1.php'>special/fairy1.php</a></li>
<li><a href='source.php?url=/logd/special/findgem.php'>special/findgem.php</a></li>
<li><a href='source.php?url=/logd/special/findgold.php'>special/findgold.php</a></li>
<li><a href='source.php?url=/logd/special/glowingstream.php'>special/glowingstream.php</a></li>
<li><a href='source.php?url=/logd/special/grassyfield.php'>special/grassyfield.php</a></li>
<li><a href='source.php?url=/logd/special/oldmanbet.php'>special/oldmanbet.php</a></li>
<li><a href='source.php?url=/logd/special/oldmanpretty.php'>special/oldmanpretty.php</a></li>
<li><a href='source.php?url=/logd/special/oldmantown.php'>special/oldmantown.php</a></li>
<li><a href='source.php?url=/logd/special/oldmanugly.php'>special/oldmanugly.php</a></li>
<li><a href='source.php?url=/logd/special/riddles.php'>special/riddles.php</a></li>
<li><a href='source.php?url=/logd/special/skillmaster.php'>special/skillmaster.php</a></li>
</ul><h1><a name='source'>Source of: /logd/viewpetition.php</a></h1><code><font color="#000000">
<font color="#0000BB">&lt;?<br /></font><font color="#007700">require_once </font><font color="#DD0000">"common.php"</font><font color="#007700">;<br />if (</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">superuser</font><font color="#007700">]&lt;</font><font color="#0000BB">2</font><font color="#007700">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">page_header</font><font color="#007700">(</font><font color="#DD0000">"INFIDEL!"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"For attempting to defile the gods, you have been smitten down!"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnews</font><font color="#007700">(</font><font color="#DD0000">"`&amp;"</font><font color="#007700">.</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">name</font><font color="#007700">].</font><font color="#DD0000">" was smote down for attempting to defile the gods (they tried to hack superuser pages)."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">hitpoints</font><font color="#007700">]=</font><font color="#0000BB">0</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$session</font><font color="#007700">[</font><font color="#0000BB">user</font><font color="#007700">][</font><font color="#0000BB">alive</font><font color="#007700">]=</font><font color="#0000BB">0</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Daily News"</font><font color="#007700">,</font><font color="#DD0000">"news.php"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">page_footer</font><font color="#007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;exit();<br />}<br /><br /></font><font color="#0000BB">$statuses</font><font color="#007700">=array(</font><font color="#0000BB">0</font><font color="#007700">=&gt;</font><font color="#DD0000">"`bUnseen`b"</font><font color="#007700">,</font><font color="#DD0000">"Seen"</font><font color="#007700">,</font><font color="#DD0000">"Closed"</font><font color="#007700">);<br /><br />if (</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"del"</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"DELETE FROM petitions WHERE petitionid='$_GET</font><font color="#007700">[</font><font color="#DD0000">id</font><font color="#007700">]</font><font color="#DD0000">'"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]=</font><font color="#DD0000">""</font><font color="#007700">;<br />}<br /></font><font color="#0000BB">page_header</font><font color="#007700">(</font><font color="#DD0000">"Petition Viewer"</font><font color="#007700">);<br /></font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Return to the grotto"</font><font color="#007700">,</font><font color="#DD0000">"superuser.php"</font><font color="#007700">);<br /></font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Return to the mundane"</font><font color="#007700">,</font><font color="#DD0000">"village.php"</font><font color="#007700">);<br />if (</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">""</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"DELETE FROM petitions WHERE status=2 AND date&lt;'"</font><font color="#007700">.</font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">"Y-m-d H:i:s"</font><font color="#007700">,</font><font color="#0000BB">strtotime</font><font color="#007700">(</font><font color="#DD0000">"-7 days"</font><font color="#007700">)).</font><font color="#DD0000">"'"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#0000BB">setstat</font><font color="#007700">]!=</font><font color="#DD0000">""</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"UPDATE petitions SET status='</font><font color="#007700">{</font><font color="#DD0000">$_GET</font><font color="#007700">[</font><font color="#DD0000">'setstat'</font><font color="#007700">]}</font><font color="#DD0000">' WHERE petitionid='</font><font color="#007700">{</font><font color="#DD0000">$_GET</font><font color="#007700">[</font><font color="#DD0000">'id'</font><font color="#007700">]}</font><font color="#DD0000">'"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">//output($sql);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"SELECT petitionid,accounts.name,petitions.date,petitions.status FROM petitions LEFT JOIN accounts ON accounts.acctid=petitions.author ORDER BY status ASC, date ASC"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$result </font><font color="#007700">= </font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Refresh"</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;table border='0'&gt;&lt;tr class='trhead'&gt;&lt;td&gt;Ops&lt;/td&gt;&lt;td&gt;From&lt;/td&gt;&lt;td&gt;Sent&lt;/td&gt;&lt;td&gt;Status&lt;/td&gt;&lt;td&gt;Comments&lt;/td&gt;&lt;/tr&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;for (</font><font color="#0000BB">$i</font><font color="#007700">=</font><font color="#0000BB">0</font><font color="#007700">;</font><font color="#0000BB">$i</font><font color="#007700">&lt;</font><font color="#0000BB">db_num_rows</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);</font><font color="#0000BB">$i</font><font color="#007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">db_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"SELECT count(commentid) AS c FROM commentary WHERE section='pet-</font><font color="#007700">{</font><font color="#DD0000">$row</font><font color="#007700">[</font><font color="#DD0000">'petitionid'</font><font color="#007700">]}</font><font color="#DD0000">'"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$res </font><font color="#007700">= </font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$counter </font><font color="#007700">= </font><font color="#0000BB">db_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$res</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;tr class='"</font><font color="#007700">.(</font><font color="#0000BB">$i</font><font color="#007700">%</font><font color="#0000BB">2</font><font color="#007700">?</font><font color="#DD0000">"trlight"</font><font color="#007700">:</font><font color="#DD0000">"trdark"</font><font color="#007700">).</font><font color="#DD0000">"'&gt;&lt;td&gt;</font><font color="#007700">[</font><font color="#DD0000">&lt;a href='viewpetition.php?op=view&amp;id=$row</font><font color="#007700">[</font><font color="#DD0000">petitionid</font><font color="#007700">]</font><font color="#DD0000">'&gt;View&lt;/a&gt;|&lt;a href='viewpetition.php?op=del&amp;id=$row</font><font color="#007700">[</font><font color="#DD0000">petitionid</font><font color="#007700">]</font><font color="#DD0000">' onClick='return confirm(</font><font color="#007700">\"</font><font color="#DD0000">Are you sure you wish to delete this petition?</font><font color="#007700">\"</font><font color="#DD0000">);'&gt;Del&lt;/a&gt;|&lt;a href='viewpetition.php?setstat=0&amp;id=$row</font><font color="#007700">[</font><font color="#DD0000">petitionid</font><font color="#007700">]</font><font color="#DD0000">'&gt;Unseen&lt;/a&gt;|&lt;a href='viewpetition.php?setstat=1&amp;id=$row</font><font color="#007700">[</font><font color="#DD0000">petitionid</font><font color="#007700">]</font><font color="#DD0000">'&gt;Seen&lt;/a&gt;|&lt;a href='viewpetition.php?setstat=2&amp;id=$row</font><font color="#007700">[</font><font color="#DD0000">petitionid</font><font color="#007700">]</font><font color="#DD0000">'&gt;Close&lt;/a&gt;</font><font color="#007700">]</font><font color="#DD0000">&lt;/td&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;td&gt;$row</font><font color="#007700">[</font><font color="#DD0000">name</font><font color="#007700">]</font><font color="#DD0000">&lt;/td&gt;&lt;td&gt;$row</font><font color="#007700">[</font><font color="#DD0000">date</font><font color="#007700">]</font><font color="#DD0000">&lt;/td&gt;&lt;td&gt;</font><font color="#007700">{</font><font color="#DD0000">$statuses</font><font color="#007700">[</font><font color="#DD0000">$row</font><font color="#007700">[</font><font color="#DD0000">'status'</font><font color="#007700">]]}</font><font color="#DD0000">&lt;/td&gt;&lt;td&gt;</font><font color="#007700">{</font><font color="#DD0000">$counter</font><font color="#007700">[</font><font color="#DD0000">'c'</font><font color="#007700">]}</font><font color="#DD0000">&lt;/td&gt;&lt;/tr&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php?op=view&amp;id=$row</font><font color="#007700">[</font><font color="#DD0000">petitionid</font><font color="#007700">]</font><font color="#DD0000">"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php?op=del&amp;id=$row</font><font color="#007700">[</font><font color="#DD0000">petitionid</font><font color="#007700">]</font><font color="#DD0000">"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php?setstat=0&amp;id=$row</font><font color="#007700">[</font><font color="#DD0000">petitionid</font><font color="#007700">]</font><font color="#DD0000">"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php?setstat=1&amp;id=$row</font><font color="#007700">[</font><font color="#DD0000">petitionid</font><font color="#007700">]</font><font color="#DD0000">"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">""</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php?setstat=2&amp;id=$row</font><font color="#007700">[</font><font color="#DD0000">petitionid</font><font color="#007700">]</font><font color="#DD0000">"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;/table&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`i(Closed petitions will automatically delete themselves when they are 7 days old)`i"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`n`bKey:`b`nUnseen: No one is currently working on this problem, and it has not been dealt with yet.<br />&nbsp;&nbsp;&nbsp;&nbsp;`nSeen: Someone is probably currently working on this issue.<br />&nbsp;&nbsp;&nbsp;&nbsp;`nClosed: This issue has been dealt with, no further work should be necessary.`n`n<br />&nbsp;&nbsp;&nbsp;&nbsp;When viewing a petition, it is automatically marked as seen unless it was marked as closed. <br />&nbsp;&nbsp;&nbsp;&nbsp;If you cannot deal with a problem right away, please mark it unseen again so that someone else<br />&nbsp;&nbsp;&nbsp;&nbsp;can help the player.`n<br />&nbsp;&nbsp;&nbsp;&nbsp;Petitions that are marked \"Seen\" are probably being worked on by someone else, so please leave them<br />&nbsp;&nbsp;&nbsp;&nbsp;be unless they have been around for some time (in which case someone probably forgot to mark them unseen<br />&nbsp;&nbsp;&nbsp;&nbsp;after they looked at it).`n<br />&nbsp;&nbsp;&nbsp;&nbsp;If you have dealt with an issue, mark it closed, and it will auto delete when it is 7 days old."</font><font color="#007700">);<br />}elseif(</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#0000BB">op</font><font color="#007700">]==</font><font color="#DD0000">"view"</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#DD0000">'viewpageinfo'</font><font color="#007700">]==</font><font color="#0000BB">1</font><font color="#007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Hide Details"</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php?op=view&amp;id=</font><font color="#007700">{</font><font color="#DD0000">$_GET</font><font color="#007700">[</font><font color="#DD0000">'id'</font><font color="#007700">]}</font><font color="#DD0000">"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}else{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Show Details"</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php?op=view&amp;id=</font><font color="#007700">{</font><font color="#DD0000">$_GET</font><font color="#007700">[</font><font color="#DD0000">'id'</font><font color="#007700">]}</font><font color="#DD0000">&amp;viewpageinfo=1"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Petition Viewer"</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php"</font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Petition Ops"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Close Petition"</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php?setstat=2&amp;id=$_GET</font><font color="#007700">[</font><font color="#DD0000">id</font><font color="#007700">]</font><font color="#DD0000">"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Mark Unseen"</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php?setstat=0&amp;id=$_GET</font><font color="#007700">[</font><font color="#DD0000">id</font><font color="#007700">]</font><font color="#DD0000">"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">addnav</font><font color="#007700">(</font><font color="#DD0000">"Mark Seen"</font><font color="#007700">,</font><font color="#DD0000">"viewpetition.php?setstat=1&amp;id=$_GET</font><font color="#007700">[</font><font color="#DD0000">id</font><font color="#007700">]</font><font color="#DD0000">"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"SELECT accounts.name,accounts.login,petitions.date,petitions.status,petitionid,body,pageinfo FROM petitions LEFT JOIN accounts ON accounts.acctid=petitions.author WHERE petitionid='$_GET</font><font color="#007700">[</font><font color="#DD0000">id</font><font color="#007700">]</font><font color="#DD0000">' ORDER BY date ASC"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$result </font><font color="#007700">= </font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row </font><font color="#007700">= </font><font color="#0000BB">db_fetch_assoc</font><font color="#007700">(</font><font color="#0000BB">$result</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`@From: "</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">body</font><font color="#007700">]=</font><font color="#0000BB">stripslashes</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">body</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#DD0000">'login'</font><font color="#007700">]&gt;</font><font color="#DD0000">""</font><font color="#007700">) </font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"&lt;a href=</font><font color="#007700">\"</font><font color="#DD0000">mail.php?op=write&amp;to=$row</font><font color="#007700">[</font><font color="#DD0000">login</font><font color="#007700">]</font><font color="#DD0000">&amp;body="</font><font color="#007700">.</font><font color="#0000BB">URLEncode</font><font color="#007700">(</font><font color="#DD0000">"\n\n----- Your Petition -----\n"</font><font color="#007700">.</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">body</font><font color="#007700">]).</font><font color="#DD0000">"&amp;subject=RE:+Petition\" target=\"_blank\" onClick=\""</font><font color="#007700">.</font><font color="#0000BB">popup</font><font color="#007700">(</font><font color="#DD0000">"mail.php?op=write&amp;to=$row</font><font color="#007700">[</font><font color="#DD0000">login</font><font color="#007700">]</font><font color="#DD0000">&amp;body="</font><font color="#007700">.</font><font color="#0000BB">URLEncode</font><font color="#007700">(</font><font color="#DD0000">"\n\n----- Your Petition -----\n"</font><font color="#007700">.</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">body</font><font color="#007700">]).</font><font color="#DD0000">"&amp;subject=RE:+Petition"</font><font color="#007700">).</font><font color="#DD0000">";return false;\"&gt;&lt;img src='images/newscroll.GIF' width='16' height='16' alt='Write Mail' border='0'&gt;&lt;/a&gt;"</font><font color="#007700">,</font><font color="#0000BB">true</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`^`b$row</font><font color="#007700">[</font><font color="#DD0000">name</font><font color="#007700">]</font><font color="#DD0000">`b`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`@Date: `^`b$row</font><font color="#007700">[</font><font color="#DD0000">date</font><font color="#007700">]</font><font color="#DD0000">`b`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`@Body:`^`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$body </font><font color="#007700">= </font><font color="#0000BB">HTMLEntities</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">body</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$body </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">(</font><font color="#DD0000">"'([[:alnum:]_.-]+[@][[:alnum:]_.-]{2,}([.][[:alnum:]_.-]{2,})+)'i"</font><font color="#007700">,</font><font color="#DD0000">"&lt;a href='mailto:\\1?subject=RE: Petition&amp;body="</font><font color="#007700">.</font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"+"</font><font color="#007700">,</font><font color="#DD0000">" "</font><font color="#007700">,</font><font color="#0000BB">URLEncode</font><font color="#007700">(</font><font color="#DD0000">"\n\n----- Your Petition -----\n"</font><font color="#007700">.</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">body</font><font color="#007700">])).</font><font color="#DD0000">"'&gt;\\1&lt;/a&gt;"</font><font color="#007700">,</font><font color="#0000BB">$body</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$body </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">(</font><font color="#DD0000">"'([\\[][[:alnum:]_.-]+[\\]])'i"</font><font color="#007700">,</font><font color="#DD0000">"&lt;span class='colLtRed'&gt;\\1&lt;/span&gt;"</font><font color="#007700">,</font><font color="#0000BB">$body</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$output</font><font color="#007700">.=</font><font color="#DD0000">"&lt;span style='font-family: fixed-width'&gt;"</font><font color="#007700">.</font><font color="#0000BB">nl2br</font><font color="#007700">(</font><font color="#0000BB">$body</font><font color="#007700">).</font><font color="#DD0000">"&lt;/span&gt;"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`n`@Commentary:`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">commentary</font><font color="#007700">(</font><font color="#DD0000">"pet-</font><font color="#007700">{</font><font color="#DD0000">$_GET</font><font color="#007700">[</font><font color="#DD0000">'id'</font><font color="#007700">]}</font><font color="#DD0000">"</font><font color="#007700">,</font><font color="#DD0000">"Add"</font><font color="#007700">,</font><font color="#0000BB">200</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$_GET</font><font color="#007700">[</font><font color="#DD0000">'viewpageinfo'</font><font color="#007700">]){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">output</font><font color="#007700">(</font><font color="#DD0000">"`n`n`@Page Info:`&amp;`n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">pageinfo</font><font color="#007700">]=</font><font color="#0000BB">stripslashes</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">pageinfo</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$body </font><font color="#007700">= </font><font color="#0000BB">HTMLEntities</font><font color="#007700">(</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">pageinfo</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$body </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">(</font><font color="#DD0000">"'([[:alnum:]_.-]+[@][[:alnum:]_.-]{2,}([.][[:alnum:]_.-]{2,})+)'i"</font><font color="#007700">,</font><font color="#DD0000">"&lt;a href='mailto:\\1?subject=RE: Petition&amp;body="</font><font color="#007700">.</font><font color="#0000BB">str_replace</font><font color="#007700">(</font><font color="#DD0000">"+"</font><font color="#007700">,</font><font color="#DD0000">" "</font><font color="#007700">,</font><font color="#0000BB">URLEncode</font><font color="#007700">(</font><font color="#DD0000">"\n\n----- Your Petition -----\n"</font><font color="#007700">.</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">body</font><font color="#007700">])).</font><font color="#DD0000">"'&gt;\\1&lt;/a&gt;"</font><font color="#007700">,</font><font color="#0000BB">$body</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$body </font><font color="#007700">= </font><font color="#0000BB">preg_replace</font><font color="#007700">(</font><font color="#DD0000">"'([\\[][[:alnum:]_.-]+[\\]])'i"</font><font color="#007700">,</font><font color="#DD0000">"&lt;span class='colLtRed'&gt;\\1&lt;/span&gt;"</font><font color="#007700">,</font><font color="#0000BB">$body</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$output</font><font color="#007700">.=</font><font color="#DD0000">"&lt;span style='font-family: fixed-width'&gt;"</font><font color="#007700">.</font><font color="#0000BB">nl2br</font><font color="#007700">(</font><font color="#0000BB">$body</font><font color="#007700">).</font><font color="#DD0000">"&lt;/span&gt;"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$row</font><font color="#007700">[</font><font color="#0000BB">status</font><font color="#007700">]==</font><font color="#0000BB">0</font><font color="#007700">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$sql </font><font color="#007700">= </font><font color="#DD0000">"UPDATE petitions SET status=1 WHERE petitionid='$_GET</font><font color="#007700">[</font><font color="#DD0000">id</font><font color="#007700">]</font><font color="#DD0000">'"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$result </font><font color="#007700">= </font><font color="#0000BB">db_query</font><font color="#007700">(</font><font color="#0000BB">$sql</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></font><font color="#0000BB">page_footer</font><font color="#007700">();<br /></font><font color="#0000BB">?&gt;</font>
</font>
</code>