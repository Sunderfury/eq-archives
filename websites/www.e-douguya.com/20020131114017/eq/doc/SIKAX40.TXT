------------------------------------------------------------------------
 EQ WAVE PLAY TOOL
 SIKAX.exe Version.4.0 (c)2000 ＥＱの道具屋さん
------------------------------------------------------------------------

●目的

　EQのログファイルを監視して、特定のキーワードで指定されたWAVEファイル
を再生するためのソフトです。

　複数キーワードで、キーワード毎にWAVEファイルを選択出来る様にとの要望が
多かったため、その点を中心にバージョンアップしました。
　更に、個人的な要望で、以下の機能を追加しました。
　　正規表現による検索をサポート
　　キーワードそれぞれにたいして、ホットキーで一時停止、再開を可能に
　　ログファイルの監視間隔の調整を可能に
　　区切り文字のユーザー定義
　　設定キーワードのサンプルログとのマッチテスト機能
　　複数起動を可能に変更（ただし、ホットキーが使用できなくなります）
　　（マイナーチェンジ、複数起動時に、間違って同一パスのものを２個起動して
　　しまったりする事がやたら多いので、同一パスのSIKAXは以前のように多重起動
　　禁止にしました）

　4.0の追加項目

　多重起動時にホットキー処理が干渉して、キー入力時にシステムが不安定に
なっていたのが判明したので、２起動以降のSIKAXではホットキーを無効にしました。

　いくつかWAVEファイルを増やしました。

　ＥＱのログファイルがキャラクタ別、サーバー別になったために、ファイルを指定する
のではなく、フォルダを指定し、ログファイルは一番新しいものをオープンするように
変更しました。
　ＥＱのログファイルはＥＱのフォルダにeqlog_サーバー番号_キャラ名.txtの名前で
保存されるようになりました。
　設定ダイアログに、この処理のための間隔時間を指定するエディットボックスを追加
しました。
　ログが１バイトも更新されずに、この時間が経過すると、より新しいログファイルが存在
するかどうか指定されているフォルダ内を検索します。
　従って、あまり短く設定するとフォルダ内の検索が頻繁に起きますので、ご注意を。
　デフォルトでは６０秒になっています。
　通常キャラの切り替え時はゾーンでこれくらい掛かると思うので（ｗ


●動作環境

　動作環境は、日本語Windows95, 日本語Windows98を対象に作成されています。
WindowsNT x.0、Windows2000、Meでは動作確認を行っていません。

　また、サウンドボードによっては、ＥＱプレイ時にＷＡＶＥの再生が出来ない環境
がありえます。当方ではSoundBraster Live!で動作確認を行っています。
　その場合、もう１台のＰＣをＬＡＮ上に用意できる方は、別ＰＣで動作させ、
ネットワークドライブ越しにeqlog.txtを読むように指定するという苦肉の策もあります。

　また、本ソフトの起動中は、ログファイルの削除が行えませんので気をつけて下さい。
ただし、当サイトのEQLC.exeでログファイルを整理して、最後に削除するオプションを
使用している場合には、ログ監視を一時停止して正常に削除できます。


●インストール方法

　SIKAX.exe、sikaxlib.dll、SIKAX.INI、添付WAVEファイルを同じフォルダに
コピーして下さい。
　フォルダについてはどこでも構いませんが、添付のＩＮＩファイルの設定では
C:\Program Files\SIKAX\の下に置かれている事になっているので、そのへんが
推奨です。

　SIKAX.INIファイルには、参考のため、定義済みのキーワードと、WAVEファイルが
設定されています。
　添付のINIファイルでは、C:\Program Files\SIKAX\の下にWAVEファイル、
C:\Program Files\EverQuest\の下にログファイルが有るものとして設定されております。
　環境によっては、設定のしなおしが必要になりますので、設定画面でパスを
変更してください。INIファイルがどのようなものかわかる方はINIファイルを
直接編集しても構いません。
　エディタ等で置き換えをすると楽にパス変更できると思います。
　ただし、ＩＮＩファイルはシステムによってキャッシュされる事があり、
すぐにＳＩＫＡＸを立ち上げた場合反映されない場合もあります。
　また、ＳＩＫＡＸ起動中に手動で書き換えた場合は、終了時に上書きされてしまうので、
終了させてから変更して下さい。

　以前のバージョンの設定がある場合は、そのINIファイルを残したままにすると、
設定が引き継がれます。追加項目があるものの、変更はないので、そのまま前の
INIファイルが使用出来ます。


●アンインストール方法

　アンインストールは、SIKAX.exe、sikaxlib.dll、SIKAX.INI、添付WAVEファイルを
削除して下さい。
　システムに特に情報を保存したり登録したりはしませんので、単にファイルの削除
だけで完全にアンインストール状態になります。
　つまり、削除すれば、システムは完全に元通りと言う事です。


●使用方法

　起動すると、ログファイルの更新を監視し始め、指定されているキーワードがログに
記録されると指定されているWAVEファイルを再生します。

　また、タスクトレイには、SIKAXのアイコンが入ります。タスクトレイのアイコンを
クリックすることで、メニューが呼び出せます。
　メニューは以下の３つです。

　Config	設定
　About		バージョン情報
　-----------
　SIKAX Exit	SIKAXの終了

　Configでは、反応するキーワードと、再生するWAVEファイル、監視するログファイルが
存在するＥＱのフォルダ、区切り文字、一時停止ホットキー、ログチェック間隔を
指定します。

　また、キーワードを大文字小文字区別するかどうかと、ゲーム中の話し言葉のみで
反応するようにするのかが選択できます。

　更に、今回のバージョンアップで、ワードサーチにも一応対応しました、これは
前後を区切り文字ではさまれた単語単位でしか反応しなくなるオプションで、
例えば、SIKAと登録してあった場合に、 SIKA には反応するが、
SIKASIとかSIKATANAIとかに反応しなくなります。
　空白やカンマ以外の区切り文字については、セパレーターキャラクタの
エディットボックスに定義しておくと区切り文字として扱います。

　また、キーワードには正規表現も使用出来ます。詳しくは次項で…。

　チェックボックスのチェック項目の意味は以下の通りです。
　Ignore case　大文字小文字を区別しません。
　Speak only 　say,shout,ooc,auction等の''で括られた範囲のみチェックします。
　Word Search　単語毎にチェックします。
　Regular Expression　　　キーワード定義を正規表現として検索します。
　Use Stop/Start HotKey	　このキーワードではホットキーを使用して一時停止可能にします。

　設定画面では、キーワードのリストボックスが表示されますので、
その右のModify、Add、Deleteの各ボタンで設定用ダイアログを開いて項目を設定して
下さい。

　マッチテストでは、ログファイルの一行をコピーして、設定したキーワードで、
鳴る、鳴らないをチェックして下さい。

　ホットキー押下時には、ONの時、OFFの時それぞれ、実行ファイルと同じディレクトリの
start.wav、stop.wavを再生します。


●複数起動についての注意事項

　現在のバージョンでは、複数起動が可能になっていますが、設定ファイルが同じでは
まったく意味がないと思います。（２アカ用？）では、なぜ複数起動可能にしたか
というと、SIKAXをもう一組別のディレクトリにインストールすればINIファイルが別々に
保存され、それぞれ独立して動作させることが可能だからです。
　ただし、複数起動時に、間違って同一パスのものを２個起動して
しまったりする事がやたら多いので、同一パスのSIKAXは以前のように多重起動
禁止にしました。

　ただし、複数起動をすると、キー入力を受け付けるＤＬＬからSIKAXを探せなくなるため、
ホットキーが起動中の最初のひとつのSIKAXに対してしか使用できなくなります。


●正規表現検索

　正規表現とは、文字の一部をメタ文字という特殊な意味のものとして扱い、
色々な文字列を１つの表現で表すものです。

　検索サイト等で検索すると、分かりやすい解説ページ等があると思いますので、
詳細はそちらに譲って、実際に私がどう使うつもりで導入したかといいますと、

　１．PCからのTellの着信時に音を鳴らしたい、
　　　しかし、NPCのBankerや売り子からのTellでは鳴らしたくない。

　２．Mobのスペルキャストや、ゲートキャストで音を鳴らしたい、
　　　しかし、PCのキャストでは鳴らしたくない。

　上記２点が主な理由です。

　Tellで鳴らしたいと思えば、tells you,で音が鳴るようにすればよいのですが、
これでは、NPCのBankerや売り子からのTellでも鳴ってしまいます。
　そこで、正規表現を使用して、名前部分がシングルネームの時だけ鳴らすように
しました、
　^[^ ]+ tells you,
　これですと、シングルネームの売り子には通用しませんが、まぁ大体OKなのでNP（ｗ

　２については、１の逆でMobは大体複数ワードの名前なので、
　^.+ .+ begins to cast a spell\.
　のような感じで名前部分に最低１個はスペースが空くことを条件にしています。
　シングルネームのMobには通用しませんが、これもNp(w
　また、関係ないですが、これを登録したままCasterGuildへ行ってしまうと大変な
　事に…というわけで、一時停止ホットキーを入れたわけです(^-^;;


　サポートするメタ文字

　^　正規表現の先頭にある場合行頭にマッチします。
　$　正規表現の末尾にある場合行末にマッチします。
　.　改行以外の文字にマッチします。
　[] []内に含まれる文字のどれか１字とマッチします。
　　　a-zや0-9のような範囲指定も可能、括弧内の最初に^がある場合は
　　　含まれる文字のどれとも一致しない文字にマッチします。
　　　-を通常文字として扱いたい時は末尾に置いて下さい。
　　　^を通常文字として扱いたい時は先頭以外に置いて下さい。
　*　直前の文字の０回以上の繰り返しを意味します。
　+　直前の文字の１回以上の繰り返しを意味します。
　?　直前の文字が、無いか、１文字出現することを意味します。
　|　直前と直後のどちらかの文字が出現することを意味します。
　()　丸括弧はSIKAXの検索では意味を持ちませんが、文字列の記憶に使用します。
　　　（）を通常文字として扱いたい場合は↓のように\でエスケープして下さい。
　\メタ文字　メタ文字を通常文字として扱いたい時は、その直前に\を置いて下さい。


●使用条件

　本ソフトウェアは、フリーソフトウェアです。使用に際して料金等は発生しません。
ただし、ソフトウェアの著作権は作者が保持します。無断で本ソフトウェアを
改ざんしたり、配布する事を厳禁いたします。


●免責

　本ソフトウェアは、作者が善意で公開するものであり、ソフトウェア本体に
不具合があったり、本ソフトウェアの動作で、使用する側になんらかの不利益が
生じたとしても、作者は免責させて頂きます。ご使用に際しては、御自身の責任の
元にご利用下さい。


●配布

　配布は以下のURLのみで行っております。ソフトウェア自体の転載等はご相談下さい。

http://www.e-douguya.com/

　上記URLへのリンクはご自由にどうぞ。^^
ページの下の方にバナーを用意してありますので、使ってやって下さい^^/


●連絡

　作者は不具合等の修正や、機能追加の責は負いませんが、なるべく対応したいと
考えます。何かありましたら、上記配布サイトからリンクが張られているEQBBSに
ご連絡下さい。


●変更履歴

　 6/23, 2001 Ver.4.0  新しいログファイルを追跡するように変更
　 8/ 3, 2000 Ver.3.1  同一パスの時の多重起動禁止措置追加
　 6/21, 2000 Ver.3.0  主に正規表現対応
　 6/ 6, 2000 Ver.2.1  サポートサイト引越しに伴いリソースURLを変更
　 1/19, 2000 Ver.2.0  複数キーワード対応、外部I/F対応
　12/15, 1999 Ver.1.0  とりあえず完成


以上 6/23, 2001
------------------------------------------------------------------------
.
