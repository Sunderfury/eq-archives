------------------------------------------------------------------------
 EQ Log File Viewer

 EQLV.exe Version.1.0 (c)2000 ＥＱの道具屋さん
------------------------------------------------------------------------

●目的

　ＥＱのログを閲覧するために作成しました。
　ＥＱのログファイルは/log onコマンドでＥＱディレクトリに作成されますが、
テキストファイルになってしまうと、モノクロで非常に見にくいです。
　そこで、メッセージによって判別してＥＱのゲーム内とほぼ同じカラーで
ログが閲覧できるソフトを作成しました。
　しかし、ただログが閲覧出来るだけではなく、数々のログ解析が行えます。

●動作環境

　動作環境は、日本語Windows95, 日本語Windows98を対象に作成されています。
WindowsNT4.0では動作確認を行っていません。


●インストール方法

　EQLV.exeとmsgtbl.txtを任意の同じフォルダにコピーして下さい。フォルダについては
どこでも構いません。一般的には、EQLVというフォルダをどこかに作成してその中に
置いておくとよいでしょう。


●アンインストール方法

　アンインストールは、EQLV.exe、msgtbl.txtを削除して下さい。
また、設定情報等を保存するために、EQLV.exeと同じフォルダに出来る
EQLV.INIも削除して下さい。
　実行中は削除できませんので、終了させてから削除を行って下さい。


●使用方法

　起動すると、メニュー、ステータスバー付きのログ閲覧ウィンドウが表示されます。

　ほとんどの操作はメニューから行います。また、ログ表示部分を右クリックすることで
ポップアップするメニューには主な操作が入っています。

　各メニュー項目の説明

　File
　　Open　　　　　　　　　ログファイルをオープンします。
　　　　　　　　　　　　　もちろんEQLCでカットしたファイルもOKです。
　　Reload　　　　　　　　ログファイルを再読み込みします。
　　AddReload 　　　　　　ログファイルの増えた部分を再読み込みします。
　　　　　　　　　　　　　LAN上の別のＰＣでＥＱをプレイしているとき、
　　　　　　　　　　　　　拡張チャットウィンドウとしての利用も出来ます。
　　　　　　　　　　　　　EditメニューのAutoReloadを選ぶと自動的に
　　　　　　　　　　　　　AddReloadを繰り返します。
　　最近閲覧したファイル　最近閲覧したファイルを５つまで直接オープン出来ます。
　　Exit　　　　　　　　　EQLVを終了します。

　Edit
　　Copy　　　　　　　　　選択した範囲の行をクリップボードにコピーします。
　　　　　　　　　　　　　選択は行単位です。
　　Select All　　　　　　ログファイル全体を選択します。
　　Search　　　　　　　　文字列検索ダイアログを開きます。
　　　　　　　　　　　　　ワードサーチ、大文字小文字を区別、正規表現サーチが
　　　　　　　　　　　　　可能です。
　　Search Before 　　　　前回検索した文字列を前方向に再検索します。
　　Search Next 　　　　　前回検索した文字列を後方向に再検索します。

　View
　　Date　　　　　　　　　ログの各行の日付を表示します。
　　Time　　　　　　　　　ログの各行の時間を表示します。
　　Font　　　　　　　　　フォント選択ダイアログを開きます。
　　Auto Reload 　　　　　１０秒毎に自動的に追加再読み込みを行うモードに切り替えます。
　　　　　　　　　　　　　LAN上の別のＰＣでＥＱをプレイしているとき、
　　　　　　　　　　　　　拡張チャットウィンドウとしての利用も出来ます。

　Tool
　　Attack Sum　　　　　　戦闘情報を集計します。
　　Faction Sum 　　　　　ファクション情報を集計します。
　　Random Sum　　　　　　ランダム情報を集計します。
　　Loot Sum　　　　　　　ルートアイテム情報を集計します。
　　Exp Sum 　　　　　　　経験値情報を集計します。
　　Skill Sum 　　　　　　スキルアップ情報を集計します。

　Help
　　About EQLV　　　　　　バージョン情報ダイアログを開きます。
　　Web Page　　　　　　　サポートWebサイトを開きます。


●メッセージ色定義

　EQLVでは、EQのチャットウィンドウとほぼ同じ色でテキストを表示します。
　この処理の要はmsgtbl.txtに定義された色定義とメッセージの正規表現です。
　正規表現を使用することで、似たようなメッセージをまとめることが可能です。
　EQLVで定義されていないメッセージは白文字で表示されます。
　もし、定義されていないメッセージに出会った場合は、以下の説明に従って
msgtbl.txtに追加してみて下さい。
　
　行頭に;をおくとコメントになります。
　# colorから後ろが色定義です。
　カンマで区切ってある数字の左からＲＧＢの色成分の０から２５５までの数値を
定義します。定義した順に０〜１５までの番号で後にメッセージの色として使用します。

; EQLV Message Format Data File Ver.1.0
; colors
# color
0,0,0		; 0		Black
0,0,128		; 1		Dark Red
0,128,0		; 2		Dark Green
0,128,128	; 3		Dark Yellow
128,0,0		; 4		Dark Blue
128,0,128	; 5		Dark Parple
128,128,0	; 6		Dark Sky Blue
128,128,128	; 7		Dark Gray
192,192,192	; 8		Gray
0,0,255		; 9		Red
128,255,128	; 10	Green
0,255,255	; 11	Yellow
255,0,0		; 12	Blue
255,0,255	; 13	Parple
255,255,0	; 14	Sky Blue
255,255,255	; 15	White
; messages
# message
; battle message ================================
9,YOU for [a-zA-Z0-9 ]+ of damage\.$
9,YOU for [a-zA-Z0-9 ]+ of damage\.$

　# messageから後ろが実際のメッセージの正規表現定義です。
　まず、最初のカンマの前の数字がそのメッセージの色をあらわします。
　その後カンマの後ろにメッセージにマッチする正規表現を記述します。

　正規表現とは、文字の一部をメタ文字という特殊な意味のものとして扱い、
色々な文字列を１つの表現で表すものです。

　検索サイト等で検索すると、分かりやすい解説ページ等があると思いますので、
詳細はそちらを参照して下さい。

　サポートするメタ文字

　^　正規表現の先頭にある場合行頭にマッチします。
　$　正規表現の末尾にある場合行末にマッチします。
　.　改行以外の文字にマッチします。
　[] []内に含まれる文字のどれか１字とマッチします。
　　　a-zや0-9のような範囲指定も可能、括弧内の最初に^がある場合は
　　　含まれる文字のどれとも一致しない文字にマッチします。
　　　-を通常文字として扱いたい時は末尾に置いて下さい。
　　　^を通常文字として扱いたい時は先頭以外に置いて下さい。
　*　直前の文字の０回以上の繰り返しを意味します。
　+　直前の文字の１回以上の繰り返しを意味します。
　?　直前の文字が、無いか、１文字出現することを意味します。
　|　直前と直後のどちらかの文字が出現することを意味します。
　()　丸括弧はEQLVの検索では意味を持ちませんが、文字列の記憶に使用します。
　　　（）を通常文字として扱いたい場合は↓のように\でエスケープして下さい。
　\メタ文字　メタ文字を通常文字として扱いたい時は、その直前に\を置いて下さい。
　 　　　　　\自身を表したいときも\\と記述する必要があります。

　ＥＱのメッセージは相当な数にのぼり、msgtbl.txtは全てのメッセージを網羅している
わけでは有りません。スペルの効果など多岐にわたり、とても、私と協力者数名では
追いつかない状態です（ｗ
　そこで、いずれ、専用ＢＢＳを作成して未サポートのメッセージを募集したいと
思います。よろしくお願いいたしますm(__m

　アップデートされたmsgtbl.txtは、差し替え版として配布する予定です。


●戦闘情報解析

　選択範囲の戦闘情報の解析が行えます。
　戦闘関係のフィルターがONになっている状態ならば、ほぼ全ての個対個の
戦闘情報を集計します。
　ＰＣ→ＮＰＣはもとより、ＰＣ→ＰＣ、ＮＰＣ→ＰＣまでサポートします。
また[ALL]の部分には各段階で小計も算出されます。
　見出しのタブをクリックすると、その項目で昇順、降順でソートが行えますので、
複数のソートを行うと、比較したい行をまとめることが可能です。
　不要なデータは右クリックで出るメニューから切り取りや削除を行うと、見やすく
なります。
　複数行のコピーや切り取りは、クリップボードにＣＳＶ形式で保存しますので、
テキストファイルに保存して拡張子をＣＳＶにするとＥｘｅｌなどで管理できます。
　１行だけのコピーの場合は、名前と値がタブで区切られ、項目毎に改行された
テキストがクリップボードに入ります。

Name　　　　　　攻撃側の名前です。ＰＣもＮＰＣも含まれます。
To　　　　　　　被攻撃側の名前です。
Weapon　　　　　攻撃に使われた武器の種類です。
Total Dmg 　　　総ダメージです。
Hit Ave.　　　　ヒットした攻撃の１回辺りの平均ダメージです。
Total Ave.　　　トータルの攻撃の１回辺りの平均ダメージです。
Max Dmg.　　　　最大ダメージ値です。
Min Dmg 　　　　最小ダメージ値です。
Total 　　　　　トータルの攻撃回数です。
Hit 　　　　　　ヒットした回数です。
Hit Rate　　　　ヒットした割合を百分率で表示します。
Miss　　　　　　ミスした回数です。
Miss Rate 　　　ミスの割合を百分率で表示します。（初期表示は幅が０です）
Parry 　　　　　Parryされた回数です。
Parry Rate　　　Parryされた割合を百分率で表示します。（初期表示は幅が０です）
Dodge 　　　　　Dodgeされた回数です。
Dodge Rate　　　Dodgeされた割合を百分率で表示します。（初期表示は幅が０です）
Riposte 　　　　Riposteされた回数です。
Riposte Rate　　Riposteされた割合を百分率で表示します。（初期表示は幅が０です）
Skin　　　　　　Skinで吸収された回数です。
Skin Rate 　　　Skinで吸収された割合を百分率で表示します。（初期表示は幅が０です）
Invu　　　　　　魔法攻撃しか効かない敵を通常武器で殴った回数です（ｗ
Invu Rate 　　　無効だった攻撃の割合を百分率で表示します。（初期表示は幅が０です）
Delay Ave 　　　選択範囲のこの種類の攻撃について、攻撃それぞれの平均間隔時間です。
Critical　　　　クリティカルの回数です。
Max Critical　　クリティカルの最大ダメージです。
Min Critical　　クリティカルの最小ダメージです。
Total Critical　クリティカルの総ダメージです。
Ave Critical　　クリティカルの平均ダメージです。
Critical Rate 　クリティカルの発生率です。


●ファクション情報解析

　選択範囲のファクションの上下をカウントしてリストします。


●ランダム情報解析

　ランダムの数値をリストとして表示します。
　EQLVは範囲指定できますし、項目ごとにソートも出来るので、
多人数のロール結果も一目瞭然です。


●ルートアイテム集計

　パーティメンバーがルートしたアイテムの一覧です。
　ログファイルには自分のルート品は残らないので、当然ながら
自分がルートしたアイテムは一覧にのりません。気をつけましょう（ｗ


●経験値集計

　経験値を取得した回数を表示します。


●スキルアップ情報集計

　スキルアップしたスキルと値、どのくらい上がったのかを表示します。
　ファイルに保存したいという要望もあるような気がしますが、EQLCの方
で対応したほうが楽に管理できるかと思うのでいずれあちらで…。


●使用条件

　本ソフトウェアは、フリーソフトウェアです。使用に際して料金等は発生しません。
ただし、ソフトウェアの著作権は作者が保持します。無断で本ソフトウェアを
改ざんしたり、配布する事を厳禁いたします。


●免責

　本ソフトウェアは、作者が善意で公開するものであり、ソフトウェア本体に
不具合があったり、本ソフトウェアの動作で、使用する側になんらかの不利益が
生じたとしても、作者は免責させて頂きます。ご使用に際しては、御自身の責任の
元にご利用下さい。


●配布

　配布は以下のURLのみで行っております。ソフトウェア自体の転載等はご相談下さい。

http://www.e-douguya.com/

　上記URLへのリンクはご自由にどうぞ。^^
ページの下の方にバナーを用意してありますので、使ってやって下さい^^/


●連絡

　作者は不具合等の修正や、機能追加の責は負いませんが、なるべく対応したいと
考えます。何かありましたら、上記配布サイトからリンクが張られているEQBBSに
ご連絡下さい。


●すぺしゃるさんくす
　ＩＲＣ上でメッセージの色をコーチしてくれた皆様方さんくすー
　Salessさん、Izouさん、Chunさん、Chaozelさん、Macsさん、他多数（ｗ
　あと、こっそり実験台ログを取られていた皆様（ｗ


●変更履歴

　8/7, 2000 Ver.1.0  とりあえず完成


以上 8/7, 2000
------------------------------------------------------------------------
.
