<HTML>

<HEAD>
<SCRIPT LANGUAGE="JavaScript">

//write your code here
//var f = document.calc

function doit(f){
   var tot = 0, wttot = 0
   var tname, pname, mname, wname
   loop:
   for(i=1; i<14; i++){
      tname = "t" + i
      if(f.tname == "")
	break loop
      else{
	pname = "p" + i
	mname = "m" + i
	wname = "w" + i
	if(f.scoreMethod[0].checked){
		if(f["p"+i].value == "")
			continue
		if(f["m"+i].value == "")
			continue
		}
	//alert(tot)
	if((f["p"+i].value == "") || (f["m"+i].value == ""))
		//f["p"+i].value = 0
		tot = tot + (0 * f["w"+i].value)/1
	//if(f["m"+i].value == "")
		//f["m"+i].value = 1
	else
	tot = tot + (f["p"+i].value * f["w"+i].value)/f["m"+i].value
	//alert(wttot)
	wttot = wttot + (f["w"+i].value - 0)
	}
      }
    tot = (tot/wttot) * 100
    if(f.round.checked){
	tot = Math.round(tot)}
    //alert(tot)
    f.score.value = tot + "%"
f.grade.value = "F"
if(tot >= 50)
	f.grade.value = "D"
if(tot >= 55)
	f.grade.value = "D+"
if(tot >= 60)
	f.grade.value = "C-"
if(tot >= 65)
	f.grade.value = "C"
if(tot >= 70)
	f.grade.value = "C+"
if(tot >= 75)
	f.grade.value = "B-"
if(tot >= 80)
	f.grade.value = "B"
if(tot >= 85)
	f.grade.value = "B+"
if(tot >= 90)
	f.grade.value = "A-"
if(tot >= 95)
	f.grade.value = "A"
}

function clearit(f){
	for(i=1; i<14; i++){
		f["p"+i].value = ""
		f["m"+i].value = ""
		f.score.value = ""
		f.grade.value = ""
	}
}

function chcourse(f){
   if(f.course.selectedIndex == 1){
	f.t1.value = "hw1"
	f.t2.value = "hw2"
	f.t3.value = "hw3"
	f.t4.value = "hw4"
	f.t5.value = "asg1"
	f.t6.value = "asg2"
	f.t7.value = "asg3"
	f.t8.value = "mid"
	f.t9.value = "fin"
	f.t10.value = ""
	f.t11.value = ""
	f.t12.value = ""
	f.t13.value = ""
	f.w1.value = 10
	f.w2.value = 10
	f.w3.value = 10
	f.w4.value = 10
	f.w5.value = 5
	f.w6.value = 5
	f.w7.value = 5
	f.w8.value = 15
	f.w9.value = 30
	f.w10.value = ""
	f.w11.value = ""
	f.w12.value = ""
	f.w13.value = ""
    }
    else{
f.t1.value = "hw1"
	f.t2.value = "hw2"
	f.t3.value = "hw3"
	f.t4.value = "hw4"
	f.t5.value = "hw5"
	f.t6.value = "hw6"
	f.t7.value = "hw7"
	f.t8.value = "hw8"
	f.t9.value = "hw9"
	f.t10.value = "hw10"
	f.t11.value = "hw11"
	f.t12.value = "mid"
	f.t13.value = "fin"
	f.w1.value = 5
	f.w2.value = 5
	f.w3.value = 5
	f.w4.value = 5
	f.w5.value = 5
	f.w6.value = 5
	f.w7.value = 5
	f.w8.value = 5
	f.w9.value = 5
	f.w10.value = 5
	f.w11.value = 5
	f.w12.value = 15
	f.w13.value = 30
   }
}

function pchange(elm){
var str = elm.name
  var ind = str.replace(/\D*/, "m")
	//alert(ind)
	if(elm.value < 0)
		elm.value = ""
	if( (document.calc[ind].value < elm.value) && (document.calc[ind].value != ""))
		elm.value = ""
	//alert("pcharge")
}

function mchange(elm){
  var str = elm.name
  var ind = str.replace(/\D*/, "p")
	//alert(ind)
	if(elm.value <= 0)
		elm.value = ""
	if( (document.calc[ind].value > elm.value) && (document.calc[ind].value != ""))
		elm.value = ""
	//alert("machange")
}

function addhandlers(f){
var noedit = new Function("document.calc.p1.focus()")
var mchanger = new Function("mchange(this)")
var pchanger = new Function("pchange(this)")

	for(i=1; i<14; i++){
		f["t" + i].onfocus = noedit
		f["w" + i].onfocus = noedit
		f["p" + i].onchange = pchanger
		f["m" + i].onchange = mchanger
	}
f.score.onfocus = noedit
f.grade.onfocus = noedit
//alert("addhandlers")
}

</SCRIPT>

	<TITLE>Calculate Grade</TITLE>
</HEAD>

<BODY onLoad=addhandlers(document.calc);>

<FORM NAME="calc">
<P><FONT SIZE="4">Calculate Grade from Part Scores for Course</FONT>
<SELECT NAME="course" onChange="chcourse(document.calc)">
<OPTION VALUE="5131" SELECTED>csci5131, Fall 2000</OPTION>
<OPTION VALUE="4011">csci4041, Fall 2000</OPTION>
</SELECT>
 <BR>

<TABLE BORDER="0" WIDTH="690">
	<TR>
		<TD WIDTH="60">
			<P ALIGN="RIGHT">Title
		</TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t1" SIZE="4" MAXLENGTH="4" VALUE="hw1"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t2" SIZE="4" MAXLENGTH="4" VALUE="hw2"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t3" SIZE="4" MAXLENGTH="4" VALUE="hw3"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t4" SIZE="4" MAXLENGTH="4" VALUE="hw4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t5" SIZE="4" MAXLENGTH="4" VALUE="hw5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t6" SIZE="4" MAXLENGTH="4" VALUE="hw6"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t7" SIZE="4" MAXLENGTH="4" VALUE="hw7"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t8" SIZE="4" MAXLENGTH="4" VALUE="hw8"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t9" SIZE="4" MAXLENGTH="4" VALUE="hw9"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t10" SIZE="4" MAXLENGTH="4" VALUE="hw10"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t11" SIZE="4" MAXLENGTH="4" VALUE="hw11"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t12" SIZE="4" MAXLENGTH="4" VALUE="mid"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="t13" SIZE="4" MAXLENGTH="4" VALUE="fin"></TD>
	</TR>
	<TR>
		<TD WIDTH="60">
			<P ALIGN="RIGHT">Points
		</TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p1" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p2" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p3" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p4" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p5" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p6" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p7" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p8" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p9" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p10" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p11" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p12" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="p13" SIZE="4" MAXLENGTH="4"></TD>
	</TR>
	<TR>
		<TD WIDTH="60">
			<P ALIGN="RIGHT">Maximum
		</TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m1" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m2" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m3" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m4" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m5" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m6" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m7" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m8" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m9" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m10" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m11" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m12" SIZE="4" MAXLENGTH="4"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="m13" SIZE="4" MAXLENGTH="4"></TD>
	</TR>
	<TR>
		<TD WIDTH="60">
			<P ALIGN="RIGHT">Weight
		</TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w1" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w2" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w3" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w4" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w5" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w6" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w7" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w8" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w9" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w10" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w11" SIZE="4" MAXLENGTH="4" VALUE="5"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w12" SIZE="4" MAXLENGTH="4" VALUE="15"></TD>
		<TD WIDTH="48"><INPUT TYPE="TEXT" NAME="w13" SIZE="4" MAXLENGTH="4" VALUE="30"></TD>
	</TR>
	<TR>
		<TD COLSPAN="14">
			<CENTER>
			<P>
<HR ALIGN="CENTER">
<BR>

      <TABLE BORDER="0" WIDTH="410">
				<TR>
          <TD WIDTH="400"><INPUT TYPE="RADIO" NAME="scoreMethod"  VALUE="1"CHECKED>Grade over completed part only<BR>
            <INPUT TYPE="RADIO" NAME="scoreMethod" VALUE="2">Grade over entire course with zeros for missing scores</TD>
				</TR>
				<TR>
          <TD WIDTH="400"><INPUT TYPE="CHECKBOX" NAME="round" CHECKED>Round final score to nearest integer before computing
						grade</TD>
				</TR>
				<TR>
          <TD WIDTH="400">
						<P ALIGN="CENTER"><INPUT TYPE="BUTTON" NAME="calculate" VALUE="Calculate" onClick="doit(document.calc)">
					</TD>
				</TR>
				<TR>
          <TD WIDTH="400">
						<P ALIGN="CENTER"><INPUT TYPE="BUTTON" NAME="clear" VALUE="Clear" onClick="clearit(document.calc)">
					</TD>
				</TR>
			</TABLE>

</CENTER>
		</TD>
	</TR>
</TABLE>
<BR>
<BR>
<FONT SIZE="4">The resulting grade is: <INPUT TYPE="TEXT" NAME="grade" SIZE="4" MAXLENGTH="4"> from an overall
percentage score of: <INPUT TYPE="TEXT" NAME="score" SIZE="10" MAXLENGTH="10"></FONT>
</FORM>

</BODY>

</HTML>
<BR><H5>The views and opinions expressed in this page are strictly those of the page author.<BR>The contents of this page have not been reviewed or approved by the University of Minnesota.</H5>