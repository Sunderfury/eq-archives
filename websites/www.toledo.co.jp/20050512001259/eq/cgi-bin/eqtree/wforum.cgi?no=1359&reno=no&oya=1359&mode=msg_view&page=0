<html>
<head>
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=Shift_JIS">
<STYLE type="text/css">
<!--
body,tr,td,th { font-size: 11pt }
a:link        { font-size: 11pt; color:#FFFFC0 }
a:visited     { font-size: 11pt; color:#CCCC00 }
a:active      { font-size: 11pt; color:#FF6699 }
a:hover       { font-size: 11pt; color:#FF6699 }
span          { font-size: 18pt }
big           { font-size: 13pt }
small         { font-size: 9pt }
-->
</STYLE>
<title>EQ Tree BBS</title></head>
<body bgcolor=#000060 text=#FFFFFF link=#FFFFC0 vlink=#CCCC00 alink=#FF6699>

<center><font color="#FFFFFF" size=6 face="ＭＳ Ｐゴシック"><b><span>EQ Tree BBS</span></b></font>
<hr width='95%'>
[<a href="./wforum.cgi?page=0">記事リスト</a>]
[新規投稿]
[<a href="./wforum.cgi?mode=new_sort">新着記事</a>]
[<a href="./wforum.cgi?mode=find">ワード検索</a>]
[<a href="./wf_admin.cgi">管理用</a>]
</center><hr width='95%'>
<P><TT><font face="ＭＳ ゴシック">
<b>投稿時間：</b>05/01/14(Fri) 19:49<br>
<B>投稿者名：Hal*@Majop</B><BR>
<B>Ｅメール：</B><BR>
<B>ＵＲＬ　：</B><BR>
<b>タイトル：<font color=#FF9999>Rebuffマクロ</font></b>
<P><blockquote><pre>local _units          = { [0] = 'player', 'party1', 'party2', 'party3', 'party4' }<br><br>function isUnitBuffUp(sUnitname, sBuffname) <br>  local iIdx = 1<br>  while (UnitBuff(sUnitname, iIdx)) do<br>    if (string.find(UnitBuff(sUnitname, iIdx), sBuffname)) then<br>      return iIdx<br>    end<br>    iIdx = iIdx + 1<br>  end<br>  return 0<br>end<br><br>function isReBuff(sUnitname, sBuffname, iTimeout) <br>  local bRet = true<br>  local _buff_id = isUnitBuffUp( sUnitname, sBuffname )<br>  if( _buff_id ) then<br>    if( iTimeout &gt;= GetPlayerBuffTimeLeft( _buff_id ) ) then<br>      CastSpellByName( sBuffname )<br>    else<br>      bRet = false<br>    end<br>  else<br>    CastSpellByName( sBuffname )<br>  end<br>  return bRet<br>end<br><br>function GrpReBuff(sBuffname, iTimeout)<br>  local bRet         = false<br>  local memberCount  = GetNumPartyMembers()<br>  local grpindex     = 1<br>  local message_text = nil<br><br>  for grpindex = 1,memberCount do<br>    TargetUnit( _units[grpindex] )<br>    bRet = isReBuff( "target", sBuffname, iTimeout )<br><br>    if (string.find(UnitClass( _units[grpindex] ), "Hunter")) then<br>      TargetUnitsPet( _units[grpindex] );<br>      if ( UnitIsUnit("pet", "target") ) then<br>        bRet = isReBuff( "target", sBuffname, iTimeout )<br>      end<br>    end<br>    if (string.find(UnitClass( _units[grpindex] ), "Warlock")) then<br>      TargetUnitsPet( _units[grpindex] );<br>      if ( UnitIsUnit("pet", "target") ) then<br>        bRet = isReBuff( "target", sBuffname, iTimeout )<br>      end<br>    end<br>  end<br><br>  if( bRet ) then<br>    message_text = 'Casting &lt; %s &gt; on [ %t ]',<br>    message_text = string.gsub(message_text, '%%s', sBuffname)<br>    message_text = string.gsub(message_text, '%%t', UnitName("target"))<br>  else<br>    message_text = 'No Need Rebuff &lt; %s &gt;'<br>    message_text = string.gsub(message_text, '%%s', sBuffname)<br>  end<br>  SendChatMessage(message_text, 'PARTY')<br>end</pre></blockquote></font></TT><P>
<hr width='95%'>
<blockquote>
以下は関連一覧ツリーです。
<DL>
<DT><a href="./wforum.cgi?mode=all_read&no=1359&page=0">▼</a> -   <a href="./wforum.cgi?no=1359&reno=no&oya=1359&mode=msg_view">Rebuffマクロ</a> - <B>Hal*@Majop</B> 05/01/14(Fri) 19:49 <font color=#FF9999><B>No.1359</B></font>
<DL><DT>*  <a href="./wforum.cgi?no=1360&reno=1359&oya=1359&mode=msg_view">Re: Rebuffマクロ</a> - <B>POS</B> 05/01/21(Fri) 12:53 <font color=#F0F0F0>No.1360</font>
</DL><DL><DL><DT>*  <a href="./wforum.cgi?no=1361&reno=1360&oya=1359&mode=msg_view">Re^2: Rebuffマクロ</a> - <B>HAL</B> 05/01/24(Mon) 16:17 <font color=#F0F0F0>No.1361</font>
</DL></DL></DL>
</blockquote>
<hr width='95%'><center><a name="msg"></a>
<h4>このメッセージに返信する場合は下記フォームから投稿して下さい。</h4></center>
<form action="./wforum.cgi" method="POST">
<input type=hidden name=page value="0">
<input type=hidden name=action value="res_msg">
<input type=hidden name=no value="1359">
<input type=hidden name=oya value="1359">
<input type=hidden name=mode value="form">
<blockquote>
<table border=0 cellspacing=0 cellpadding=1>
<tr>
  <td nowrap><b>おなまえ</b></td>
  <td>
    <input type=text name=name size="20" value="">
  </td>
</tr>
<tr>
  <td nowrap><b>Ｅメール</b></td>
  <td>
    <input type=text name=email size="20" value="">
  </td>
</tr>
<tr>
  <td nowrap><b>題 　 名</b></td>
  <td>
    <input type=text name=title size="27" value="Re: Rebuffマクロ"> 
    <INPUT TYPE=submit VALUE="投稿する"><INPUT TYPE=reset VALUE="リセット">
  </td>
</tr>
<tr>
  <td colspan=2>
    <b>メッセージ</b>　　　
    <input type=radio name=wrap value="soft" checked>手動改行
    <input type=radio name=wrap value="hard">強制改行
    <input type=radio name=wrap value="pre">図表モード<BR>
    <textarea name=msg rows=10 cols="64" wrap="soft">> local _units          = { [0] = 'player', 'party1', 'party2', 'party3', 'party4' }> > function isUnitBuffUp(sUnitname, sBuffname) >   local iIdx = 1>   while (UnitBuff(sUnitname, iIdx)) do>     if (string.find(UnitBuff(sUnitname, iIdx), sBuffname)) then>       return iIdx>     end>     iIdx = iIdx + 1>   end>   return 0> end> > function isReBuff(sUnitname, sBuffname, iTimeout) >   local bRet = true>   local _buff_id = isUnitBuffUp( sUnitname, sBuffname )>   if( _buff_id ) then>     if( iTimeout &gt;= GetPlayerBuffTimeLeft( _buff_id ) ) then>       CastSpellByName( sBuffname )>     else>       bRet = false>     end>   else>     CastSpellByName( sBuffname )>   end>   return bRet> end> > function GrpReBuff(sBuffname, iTimeout)>   local bRet         = false>   local memberCount  = GetNumPartyMembers()>   local grpindex     = 1>   local message_text = nil> >   for grpindex = 1,memberCount do>     TargetUnit( _units[grpindex] )>     bRet = isReBuff( "target", sBuffname, iTimeout )> >     if (string.find(UnitClass( _units[grpindex] ), "Hunter")) then>       TargetUnitsPet( _units[grpindex] );>       if ( UnitIsUnit("pet", "target") ) then>         bRet = isReBuff( "target", sBuffname, iTimeout )>       end>     end>     if (string.find(UnitClass( _units[grpindex] ), "Warlock")) then>       TargetUnitsPet( _units[grpindex] );>       if ( UnitIsUnit("pet", "target") ) then>         bRet = isReBuff( "target", sBuffname, iTimeout )>       end>     end>   end> >   if( bRet ) then>     message_text = 'Casting &lt; %s &gt; on [ %t ]',>     message_text = string.gsub(message_text, '%%s', sBuffname)>     message_text = string.gsub(message_text, '%%t', UnitName("target"))>   else>     message_text = 'No Need Rebuff &lt; %s &gt;'>     message_text = string.gsub(message_text, '%%s', sBuffname)>   end>   SendChatMessage(message_text, 'PARTY')> end</textarea>
  </td>
</tr>
<tr>
  <td nowrap><b>ＵＲＬ</b></td>
  <td>
    <input type=text name="url" size="52" value="http://">
  </td>
</tr>
<tr>
  <td nowrap><b>削除キー</b></td>
  <td>
    <input type=password name=pwd size=8 value="" maxlength=8>
    <small>(記事削除時に使用。英数字で8文字以内)</small>
  </td>
</tr>
<tr>
  <td nowrap><b>プレビュー</b></td>
  <td><input type=checkbox name=pview value="on" ></td>
</tr>
</table>
</form></blockquote>
<hr width='95%'>
<center><form acion="./wforum.cgi" method="POST">
<input type=hidden name=page value="0">
<font color="#FFFFFF" size=2>
以下のフォームから自分の投稿した記事を削除できます</font><br>
■記事No<input type=text name=usr_no size=4>
■削除キー<input type=password name=usr_key size=6>
<input type=submit value="記事削除">
<input type=hidden name=mode value="usr_del">
</form><hr width='95%'></center>
<br><br><center><small><!-- Web Forum v2.5 -->
- <a href="http://www.kent-web.com/" target="_top">Web Forum</a> -
</small></center>
</body></html>
