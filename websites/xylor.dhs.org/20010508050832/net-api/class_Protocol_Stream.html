<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Protocol_Stream class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.6 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Protocol_Stream  Class Reference</h1>Class used to run packets through our protocol. 
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="Protocol_Stream_h-source.html">Protocol_Stream.h</a>&gt;</code>
<p>
<a href="class_Protocol_Stream-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Public Methods</h2></td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#a0">Protocol_Stream</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#a1">~Protocol_Stream</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#a2">open</a> (const ACE_INET_Addr &amp;_local, <a class="el" href="class_Protocol_Task.html">Protocol_Task</a> *reader=0, int _recv_thread=1)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Open the stream for use.</em> <a href="#a2">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#a3">close</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Close the stream.</em> <a href="#a3">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#a4">put</a> (<a class="el" href="class_ACE_Message_Block.html">ACE_Message_Block</a> *&amp;message, ACE_Time_Value *timeout=0)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Put data into the stream.</em> <a href="#a4">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#a5">get</a> (<a class="el" href="class_ACE_Message_Block.html">ACE_Message_Block</a> *&amp;response, ACE_Time_Value *timeout=0)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Get data from the stream.</em> <a href="#a5">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#a6">run</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Run the main event loop to listen for packets, and process them.</em> <a href="#a6">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="class_Receive_Task.html">Receive_Task</a>*&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#a7">recv</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Accessor function for recv_.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#a8">recv_thread</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Accessor function for recv_thread_.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="Protocol_Stream_h.html#a1">Thread_Timer_Queue</a>*&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#a9">timer_queue</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Accessor function for timer_queue_.</em></font><br><br></td></tr>
<tr><td colspan=2><br><h2>Protected Methods</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="Protocol_Stream_h.html#a0">Stream</a>&amp;&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#b0">stream</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Accessor function for stream_.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#b1">open</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Install the various protocol tasks into the stream.</em></font><br><br></td></tr>
<tr><td colspan=2><br><h2>Protected Attributes</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="Protocol_Stream_h.html#a0">Stream</a>&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#n0">stream_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>The stream managing the various protocol tasks.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="class_Receive_Task.html">Receive_Task</a>*&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#n1">recv_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>The task used to listen on the local port.</em> <a href="#n1">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#n2">recv_thread_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Flag to keep track of if the receive thread is running in a seperate thread.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="Protocol_Stream_h.html#a1">Thread_Timer_Queue</a>&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#n3">timer_queue_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Our queue which will process callbacks on timeouts.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="class_Protocol_Stream.html#n4">MLD</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Our memory leak detector.</em></font><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Class used to run packets through our protocol.
<p>
The Protocol_Stream provides a tidy interface to an ACE_Stream setup to process a data block through a series of protocol stages.
<p>
An ACE_Stream is a collection of ACE_Modules. You can think of it as a doubly-linked list if you like. Each Module contains two <a class="el" href="class_ACE_Task.html">ACE_Task</a> derivatives. One of these tasks is used when sending data "upstream", the other is used for "downstream" operation. In some cases, you'll only need to move data in one direction. To provide a placeholder for the other direction, ACE_Thru_Task can be used. ACE_Thru_Task responds to the <a class="el" href="class_Protocol_Stream.html#a4">put</a>() by simply invoking put_next() to send the data to the next module. 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a name="a0" doxytag="Protocol_Stream::Protocol_Stream"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
Protocol_Stream::Protocol_Stream (
          </b></td>
          <td valign="bottom"><b>
void&nbsp;)
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a1" doxytag="Protocol_Stream::~Protocol_Stream"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
Protocol_Stream::~Protocol_Stream (
          </b></td>
          <td valign="bottom"><b>
void&nbsp;)
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a name="a3" doxytag="Protocol_Stream::close"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
int Protocol_Stream::close (
          </b></td>
          <td valign="bottom"><b>
void&nbsp;)
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Close the stream.
<p>
All of the tasks and modules will also be closed.     </td>
  </tr>
</table>
<a name="a5" doxytag="Protocol_Stream::get"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
int Protocol_Stream::get (
          </b></td>
          <td valign="bottom"><b>
<a class="el" href="class_ACE_Message_Block.html">ACE_Message_Block</a> *&amp; <em>response</em>, 
          </b></td>
        </tr>
        <tr>
          <td></td>
          <td><b>
ACE_Time_Value * <em>timeout</em> = 0&nbsp;)
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get data from the stream.
<p>
Get will get a packet from the message queue at the head of the stream. This is not necessary if a <em>reader</em> task is installed.     </td>
  </tr>
</table>
<a name="b1" doxytag="Protocol_Stream::open"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
int Protocol_Stream::open (
          </b></td>
          <td valign="bottom"><b>
void&nbsp;)<code> [protected]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Install the various protocol tasks into the stream.
<p>
    </td>
  </tr>
</table>
<a name="a2" doxytag="Protocol_Stream::open"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
int Protocol_Stream::open (
          </b></td>
          <td valign="bottom"><b>
const ACE_INET_Addr &amp; <em>_local</em>, 
          </b></td>
        </tr>
        <tr>
          <td></td>
          <td><b>
<a class="el" href="class_Protocol_Task.html">Protocol_Task</a> * <em>reader</em> = 0, 
          </b></td>
        </tr>
        <tr>
          <td></td>
          <td><b>
int <em>_recv_thread</em> = 1&nbsp;)
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Open the stream for use.
<p>
Provide the stream with an ACE_INET_Addr on which it can communicate. If _reader is non-null, it will be added as the reader task just below the stream head so that it can process data read from the peer.     </td>
  </tr>
</table>
<a name="a4" doxytag="Protocol_Stream::put"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
int Protocol_Stream::put (
          </b></td>
          <td valign="bottom"><b>
<a class="el" href="class_ACE_Message_Block.html">ACE_Message_Block</a> *&amp; <em>message</em>, 
          </b></td>
        </tr>
        <tr>
          <td></td>
          <td><b>
ACE_Time_Value * <em>timeout</em> = 0&nbsp;)
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Put data into the stream.
<p>
putting data into the stream will pass it through all protocol levels and send it to the peer.     </td>
  </tr>
</table>
<a name="a7" doxytag="Protocol_Stream::recv"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
<a class="el" href="class_Receive_Task.html">Receive_Task</a> * Protocol_Stream::recv (
          </b></td>
          <td valign="bottom"><b>
void&nbsp;)<code> [inline]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Accessor function for recv_.
<p>
    </td>
  </tr>
</table>
<a name="a8" doxytag="Protocol_Stream::recv_thread"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
int Protocol_Stream::recv_thread (
          </b></td>
          <td valign="bottom"><b>
void&nbsp;)<code> [inline]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Accessor function for recv_thread_.
<p>
    </td>
  </tr>
</table>
<a name="a6" doxytag="Protocol_Stream::run"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
int Protocol_Stream::run (
          </b></td>
          <td valign="bottom"><b>
void&nbsp;)
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Run the main event loop to listen for packets, and process them.
<p>
<a class="el" href="class_Protocol_Stream.html#a6">run</a>() will check to see if <a class="el" href="class_Receive_Task.html">Receive_Task</a> is being run in a seperate thread, and will wait for it to finish it so. Otherwise, it will run the reactor's handle_events loop itself (which is a good idea for debugging things in a single thread).     </td>
  </tr>
</table>
<a name="b0" doxytag="Protocol_Stream::stream"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
<a class="el" href="Protocol_Stream_h.html#a0">Stream</a> &amp; Protocol_Stream::stream (
          </b></td>
          <td valign="bottom"><b>
void&nbsp;)<code> [inline, protected]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Accessor function for stream_.
<p>
    </td>
  </tr>
</table>
<a name="a9" doxytag="Protocol_Stream::timer_queue"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
<a class="el" href="Protocol_Stream_h.html#a1">Thread_Timer_Queue</a> * Protocol_Stream::timer_queue (
          </b></td>
          <td valign="bottom"><b>
void&nbsp;)<code> [inline]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Accessor function for timer_queue_.
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a name="n4" doxytag="Protocol_Stream::MLD"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
Protocol_Stream::MLD<code> [protected]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Our memory leak detector.
<p>
    </td>
  </tr>
</table>
<a name="n1" doxytag="Protocol_Stream::recv_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
<a class="el" href="class_Receive_Task.html">Receive_Task</a> * Protocol_Stream::recv_<code> [protected]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The task used to listen on the local port.
<p>
This task sits at the tail of the stream and passes along all packets it recieves. It constructs a <a class="el" href="class_Packet.html">Packet</a> object, which contains the source of the packet, and the data.     </td>
  </tr>
</table>
<a name="n2" doxytag="Protocol_Stream::recv_thread_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
int Protocol_Stream::recv_thread_<code> [protected]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Flag to keep track of if the receive thread is running in a seperate thread.
<p>
    </td>
  </tr>
</table>
<a name="n0" doxytag="Protocol_Stream::stream_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
<a class="el" href="Protocol_Stream_h.html#a0">Stream</a> Protocol_Stream::stream_<code> [protected]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The stream managing the various protocol tasks.
<p>
    </td>
  </tr>
</table>
<a name="n3" doxytag="Protocol_Stream::timer_queue_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
<a class="el" href="Protocol_Stream_h.html#a1">Thread_Timer_Queue</a> Protocol_Stream::timer_queue_<code> [protected]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Our queue which will process callbacks on timeouts.
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="Protocol_Stream_h-source.html">Protocol_Stream.h</a></ul>
<hr><address><small>Generated at Sat Apr 28 02:43:53 2001 for OpenQuest Network API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.6 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
