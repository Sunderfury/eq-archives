<HTML>
<HEAD>
<TITLE>星空</TITLE>

<SCRIPT LANGUAGE="JavaScript1.2">
<!--

var starNo = 100;   //星の数。余り多くしないこと。文章と重なって読みにくくなります。
var starColor = new Array("#ffffff","#ffff00","#ff0000"); // 星の色。３つまで。後ろの色ほど数が少なくなります。
var minSize = 2;    // １番小さい星のサイズ
var maxSize = 10;   // １番大きい星のサイズ
var move = false;   // 星をスクロールに合わせて移動するか？。する：true　しない:false
var blink = 200;    // 星の点滅のしやすさ。小さいほど点滅しやすい。

_dom=(document.all?3:(document.getElementById?1:(document.layers?2:0)));
var starLay = '<SPAN id="dmy" style="position:absolute; visibility:hidden;"></SPAN>';
var starX = new Array(); var starY = new Array();

function getWindowSize() {
    if(_dom == 1 || _dom == 2) {
        win_width = self.innerWidth;
        win_height = self.innerHeight;
    }
    if (_dom == 3) {
        win_width = document.body.clientWidth;
        win_height = document.body.clientHeight;
    }
}

function getScrollPosX() {
    if (_dom == 1) return scrollX;
    if (_dom == 2) return pageXOffset;
    if (_dom == 3) return document.body.scrollLeft
}

function getScrollPosY() {
    if (_dom == 1) return scrollY;
    if (_dom == 2) return pageYOffset;
    if (_dom == 3) return document.body.scrollTop;
}

function showLayer(layerName){
    if (_dom == 1) document.getElementById(layerName).style.visibility = "visible";
    if (_dom == 2) document.layers[layerName].visibility = "show";
    if (_dom == 3) document.all(layerName).style.visibility = "visible";
}

function hideLayer(layerName){
    if (_dom == 1) document.getElementById(layerName).style.visibility = "hidden";
    if (_dom == 2) document.layers[layerName].visibility = "hide";
    if (_dom == 3) document.all(layerName).style.visibility = "hidden";
}

function moveLayerTo(layerName, x, y){
    if (_dom == 1) {
        document.getElementById(layerName).style.left = x;
        document.getElementById(layerName).style.top = y;
    }
    if (_dom == 2) {
        document.layers[layerName].left = x;
        document.layers[layerName].top = y;
    }
    if (_dom == 3) {
        document.all(layerName).style.pixelLeft = x;
        document.all(layerName).style.pixelTop = y;
    }
}

function star() {
    if (_dom) {
        for (var s=0; s<starNo; s++) {
            var ran = Math.random()*blink;
            if (ran < 10) {
				timer = Math.random()*1000
				setTimeout("hideLayer('star"+s+"')",timer);
				setTimeout("showLayer('star"+s+"')",timer+500);
			}
            if (move) moveLayerTo("star"+s,starX[s]+getScrollPosX(),starY[s]+getScrollPosY());
        }
        setTimeout("star()",1000);
    }
}

function init() {
	for (var s=0; s<starNo; s++) {
	    starX[s] =  Math.floor(Math.random()*(win_width-maxSize-5));
	    starY[s] =  Math.floor(Math.random()*(win_height-maxSize-5));
		moveLayerTo("star"+s,starX[s],starY[s]);
		if (_dom == 3) document.all["star"+s].style.zIndex = -1;
	}
	star();
}


// -->
</SCRIPT>
</HEAD>

<BODY BGCOLOR="black" TEXT="white">

<SCRIPT LANGUAGE="JavaScript1.2">
<!--
if (_dom == 1) document.writeln('<DIV style="position:relative;z-index:2">');
if (_dom == 2) document.writeln('<LAYER left="10" top="10" z-index="2">');
// -->
</SCRIPT>

<P><B><FONT size="6">星　空</FONT></B><BR>
<B><FONT color="#ff0000" size="4">IE4以上　NN4以上</FONT></B></P>
<HR>
<P>2000/11/7　全面的にScript修正。同時にNN6にも対応。<BR>
<BR>
水色をHEAD内へ入れる。<BR>
黄色をBODY内の先頭に入れる。<BR>
緑色をBODY内の最後に入れる。<BR>
<BR>
縦長のページにも対応できるようにスクロールに合わせて移動する機能がありますが動作が鈍いです。<BR>
パソコン及びブラウザーの性能が上がらない限り動作を早くする方法は残念ながらありません。<BR>
その為、出来る限り縦長のPAGEでは使わない方が良いです。</P>
<HR>

<SCRIPT type="text/javascript">
<!--
function CopyToClipBoard() {
textRange = document.body.createTextRange();
textRange.moveToElementText(source);
textRange.execCommand("Copy");
}
if ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 4) && (navigator.userAgent.indexOf("Win") > 0)) {
document.write('<INPUT type="button" value="ソースをクリップボードへコピー" onclick="CopyToClipBoard();">');
document.write('<BR><BR>');
}
// -->
</SCRIPT>

<DIV id="source"><TT><NOBR>
&lt;HTML><BR>
&lt;HEAD><BR>
&lt;TITLE>星空&lt;/TITLE><BR>
<BR>
<FONT color="#00ffff">&lt;SCRIPT LANGUAGE="JavaScript1.2"><BR>
&lt;!--<BR>
<BR>
var starNo = 100;&nbsp;&nbsp; //星の数。余り多くしないこと。文章と重なって読みにくくなります。<BR>
var starColor = new Array("#ffffff","#ffff00","#ff0000"); // 星の色。３つまで。後ろの色ほど数が少なくなります。<BR>
var minSize = 2;&nbsp;&nbsp;&nbsp;&nbsp;// １番小さい星のサイズ<BR>
var maxSize = 10;&nbsp;&nbsp; // １番大きい星のサイズ<BR>
var move = true;&nbsp;&nbsp; // 星をスクロールに合わせて移動するか？。する：true　しない:false<BR>
var blink = 200;&nbsp;&nbsp;&nbsp;&nbsp;// 星の点滅のしやすさ。小さいほど点滅しやすい。<BR>
<BR>
_dom=(document.all?3:(document.getElementById?1:(document.layers?2:0)));<BR>
var starLay = '&lt;SPAN id="dmy" style="position:absolute; visibility:hidden;">&lt;/SPAN>';<BR>
var starX = new Array();<BR>
var starY = new Array();<BR>
<BR>
function getWindowSize() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if(_dom == 1 || _dom == 2) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;win_width = self.innerWidth;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;win_height = self.innerHeight;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;win_width = document.body.clientWidth;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;win_height = document.body.clientHeight;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
<BR>
function getScrollPosX() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1) return scrollX;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) return pageXOffset;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) return document.body.scrollLeft<BR>
}<BR>
<BR>
function getScrollPosY() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1) return scrollY;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) return pageYOffset;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) return document.body.scrollTop;<BR>
}<BR>
<BR>
function showLayer(layerName){<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1) document.getElementById(layerName).style.visibility = "visible";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) document.layers[layerName].visibility = "show";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) document.all(layerName).style.visibility = "visible";<BR>
}<BR>
<BR>
function hideLayer(layerName){<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1) document.getElementById(layerName).style.visibility = "hidden";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) document.layers[layerName].visibility = "hide";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) document.all(layerName).style.visibility = "hidden";<BR>
}<BR>
<BR>
function moveLayerTo(layerName, x, y){<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(layerName).style.left = x;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(layerName).style.top = y;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.layers[layerName].left = x;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.layers[layerName].top = y;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.all(layerName).style.pixelLeft = x;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.all(layerName).style.pixelTop = y;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
<BR>
function star() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (var s=0; s&lt;starNo; s++) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var ran = Math.random()*blink;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ran &lt; 10) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timer = Math.random()*1000<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout("hideLayer('star"+s+"')",timer);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout("showLayer('star"+s+"')",timer+500);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (move) moveLayerTo("star"+s,starX[s]+getScrollPosX(),starY[s]+getScrollPosY());<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout("star()",1000);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
<BR>
function init() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;for (var s=0; s&lt;starNo; s++) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starX[s] =&nbsp;&nbsp;Math.floor(Math.random()*(win_width-maxSize-5));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starY[s] =&nbsp;&nbsp;Math.floor(Math.random()*(win_height-maxSize-5));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moveLayerTo("star"+s,starX[s],starY[s]);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) document.all["star"+s].style.zIndex = -1;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;star();<BR>
}<BR>
<BR>
<BR>
// --><BR>
&lt;/SCRIPT></FONT>
<BR><BR>
&lt;/HEAD><BR>
<BR>
&lt;BODY BGCOLOR="black" TEXT="white"><BR>
<BR>
<FONT color="#ffff00">&lt;SCRIPT LANGUAGE=&quot;JavaScript1.2&quot;&gt;<BR>
&lt;!--<BR>
if (_dom == 1) document.writeln('&lt;DIV style="position:relative;z-index:2">');<BR>
if (_dom == 2) document.writeln('&lt;LAYER left="10" top="10" z-index="2">');<BR>
// --><BR>
&lt;/SCRIPT></FONT><BR>
<BR>
<BR>
<FONT size="6"><B>
ここに文章</B></FONT><BR>
<BR>
<BR>
<FONT color="#00ff00">
&lt;SCRIPT LANGUAGE="JavaScript1.2"><BR>
&lt;!--<BR>
<BR>
if (_dom == 1) document.writeln('&lt;/DIV>');<BR>
if (_dom == 2) document.writeln('&lt;/LAYER>');<BR>
<BR>
getWindowSize();<BR>
for (var i=0; i&lt;starNo; i++) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;var size =&nbsp;&nbsp;Math.floor(Math.random()*(maxSize-minSize) + minSize);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;var ran = Math.random()*starNo;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (ran &lt; starNo*0.1) colorNo = 2;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;else if (ran &lt; starNo*0.4) colorNo = 1;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;else colorNo = 0;<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1 || _dom == 3) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starLay
+= '&lt;SPAN id=&quot;star' + i + '&quot;
style=&quot;position:absolute; width:' +
size +<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
'px; left:0px; top=0px; font-size:' + size
+ 'px; color:' + starColor[colorNo] +<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
'; z-index:1; visibility:visible;&quot;&gt;★&lt;/SPAN&gt;';<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (size == 1) size = 2;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starLay
+= '&lt;LAYER name=&quot;star'+ i +'&quot;
left=&quot;0&quot; top=&quot;0&quot; z-index=&quot;1&quot;&gt;&lt;FONT
color=&quot;' +<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
starColor[colorNo] + '&quot; style=&quot;font-size:'
+ size + 'px;&quot;&gt;★&lt;/FONT&gt;&lt;/LAYER&gt;\n';<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
<BR>
document.writeln(starLay);<BR>
init();
<BR>
// --><BR>
&lt;/SCRIPT></FONT><BR>
<BR>
&lt;/BODY><BR>
&lt;/HTML><BR>
</NOBR></TT></DIV>


<SCRIPT LANGUAGE="JavaScript1.2">
<!--

if (_dom == 1) document.writeln('</DIV>');
if (_dom == 2) document.writeln('</LAYER>');

getWindowSize();
for (var i=0; i<starNo; i++) {
    var size =  Math.floor(Math.random()*(maxSize-minSize) + minSize);
    var ran = Math.random()*starNo;
    if (ran < starNo*0.1) colorNo = 2;
    else if (ran < starNo*0.4) colorNo = 1;
    else colorNo = 0;

    if (_dom == 1 || _dom == 3) {
        starLay += '<SPAN id="star' + i + '" style="position:absolute; width:' + size + 'px; left:0px; top=0px; font-size:' + size + 'px; color:' + starColor[colorNo] + '; z-index:1; visibility:visible;">★</SPAN>';
    }
    if (_dom == 2) {
        if (size == 1) size = 2;
        starLay += '<LAYER name="star'+ i +'" left="0" top="0" z-index="1"><FONT color="' + starColor[colorNo] + '" style="font-size:' + size + 'px;">★</FONT></LAYER>\n';
    }
}

document.writeln(starLay);
init();

// -->
</SCRIPT>

</BODY>
</HTML>

