
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<TITLE>子Windowを開く＆子Windowのリンク変更</TITLE>
<SCRIPT language="JavaScript">
<!--
var w = 300;		// 開くWindowの幅
var h = 200;		// 開くWindowの高さ
var t = "center";	// 開く縦位置。
var l = "center";	// 開く横位置。

if (l == "center") l = (screen.availWidth-w) / 2;
if (l == "right") l = screen.availWidth-w-12;
if (t == "center") t = (screen.availHeight-h) / 2;
if (t == "bottom") t = screen.availHeight-h-31;
var cWin = window;

function wOpen(url){
	if (cWin == window || cWin.closed) {
		cWin = window.open(url,"_blank","width="+w+",height="+h+",top="+t+",left="+l);
	} else {
		if (cWin.location.href.indexOf(url) == -1) { cWin.location.href = url; }
		cWin.focus();
	}
}

// -->
</SCRIPT>
</HEAD>

<BODY>
<P><B><FONT size="6">子Windowを開く＆子Windowのリンク変更</FONT></B><BR>
<B><FONT size="4" color="#ff0000">IE4以上　NN4以上</FONT></B></P>
<HR>
子Windowが閉じてるなら新しいWindowを開いて表示します。<BR>
子Windowが開いてるならそのWindowのURLを変更します。<BR>
<BR>
注)ブラウザーのバージョンによってはブラウザーのBugで上手く行かないバージョンがあるかもしれません。<BR>
<FORM>
<HR>
<STRONG>ボタンの場合</STRONG><BR>
<BR>
<INPUT type="button" value="PAGE1" onClick="wOpen('page1.html')"><BR>
<INPUT type="button" value="PAGE2" onClick="wOpen('page2.html')"><BR>
<BR>
<TT>&lt;FORM&gt;<BR>
&lt;INPUT type=&quot;button&quot; value=&quot;PAGE1&quot; onClick=&quot;wOpen('URL')&quot;&gt;<BR>
&lt;/FORM&gt;</TT><BR>
<BR>
<STRONG>リンクの場合</STRONG><BR>
<BR>
<A href="javascript:wOpen('page1.html')">PAGE1</A><BR>
<A href="javascript:wOpen('page2.html')">PAGE2</A><BR>
<BR>
<TT>&lt;A href=&quot;javascript:wOpen('URL')&quot;&gt;PAGE1&lt;/A&gt;</TT><BR>
<HR>
</FORM>
・Head内へ挿入する。<BR>
・開く位置は"center"以外にも使えます。<BR>
<TABLE border="0" cellpadding="0" cellspacing="0">
<TR><TD>　var t = 100;</TD><TD>画面上から指定した数字の位置</TD></TR>
<TR><TD>　var t = "right";</TD><TD>画面右端</TD></TR>
<TR><TD>　var l = 100;</TD><TD>画面左から指定した数字の位置</TD></TR>
<TR><TD>　var l = "bottom";　</TD><TD>画面下端</TD></TR>
</TABLE>
　注）rightとbottomは余り使わないように。ブラウザーのバージョンやOSの違いによってずれる可能性大。<BR>
<BR>
<BR>
<STRONG>ソース</STRONG><BR>
<BR>
&lt;SCRIPT language=&quot;JavaScript&quot;&gt;<BR>
&lt;!--<BR>
var w = 300;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 開くWindowの幅<BR>
var h = 200;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 開くWindowの高さ<BR>
var t = &quot;center&quot;;&nbsp;&nbsp;&nbsp;&nbsp;// 開く縦位置。<BR>
var l = &quot;center&quot;;&nbsp;&nbsp;&nbsp;&nbsp;// 開く横位置。<BR>
<BR>
if (l == &quot;center&quot;) l = (screen.availWidth-w) / 2;<BR>
if (l == &quot;right&quot;) l = screen.availWidth-w-12;<BR>
if (t == &quot;center&quot;) t = (screen.availHeight-h) / 2;<BR>
if (t == &quot;bottom&quot;) t = screen.availHeight-h-31;<BR>
var cWin = window;<BR>
<BR>
function wOpen(url){<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (cWin == window || cWin.closed) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cWin = window.open(url,&quot;_blank&quot;,&quot;width=&quot;+w+&quot;,height=&quot;+h+&quot;,top=&quot;+t+&quot;,left=&quot;+l);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;} else {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (cWin.location.href.indexOf(url) == -1) { cWin.location.href = url; }<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cWin.focus();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
<BR>
// --&gt;<BR>
&lt;/SCRIPT&gt;<BR>

</BODY>
</HTML>





