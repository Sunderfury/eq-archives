<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<TITLE>リンクで音を鳴らす</TITLE>


<SCRIPT LANGUAGE="JAVASCRIPT">
<!--
 var mfile = "chime.wav";	// 効果音のパス

function lnkMusic(el,num) {

	var ebd = '<EMBED src="'+mfile+'" width="0" height="0" autostart="true" loop="false" repeat="false">'
	if (navigator.userAgent.indexOf("Mac")!=-1) {
		if (navigator.appName == "Microsoft Internet Explorer") {
			var ebd = '<BGSOUND SRC="' + mfile + '" loop="1">';
		}
	}

	if(document.all) {
		document.all.msc.innerHTML = ebd;
	} else if (document.layers) {
		with (document.layers.msc.document) {
			open();
			writeln(ebd);
			close();
		}
	} else { return true; }
	if (!num) {
		setTimeout('jump("'+el.href+'")',1400);	// 曲の長さによって数字を変える(1000=1秒)
	}
	return false;
}
function jump(url){
	location.href = url;
}
// -->
</SCRIPT>

</HEAD>
<BODY>
<P><FONT size="6">リンクで音を鳴らす</FONT><BR>
<FONT color="#ff0000" size="4"><B>IE4.x/5.x　NN4.x</B></FONT></P>
<HR>
<BR>


<DIV id="msc" style="position:absolute;">
<EMBED src="chime.wav" width="0" height="0" autostart="false" loop="false" repeat="false">
</DIV>

　　<A href="page1.html" onClick="return lnkMusic(this);">PAGE1</A>　　<A href="#" onClick="return lnkMusic(this,1);">音だけ鳴らしリンクしない</A><BR>

<BR>
<HR>
<P>効果音は出来るだけ短く且つファイルサイズの小さい物を使用すること。<BR>
サンプルはWAVEを使用してますがMIDIでもOKです。<BR>
<BR>
１．JavaScriptをHEAD内に書く。<BR>
２．&lt;DIV id=&quot;msc&quot; style=&quot;position:absolute;&quot;&gt;〜〜&lt;/DIV&gt; をBODY内の出来るだけ上の方へ<BR>
３．効果音を鳴らしたいリンク&lt;A&gt;に onClick=&quot;return lnkMusic(this);&quot; を追加する。<BR>
４．1番のJavaScript内と2番の&lt;EMBED&gt;内の効果音のパスを合わせる。<BR>
５．効果音の長さに合わせてJavaScript内の数字を変更する。<BR>
<BR>
音だけ鳴らすときは3番を onClick=&quot;return lnkMusic(this,1);&quot; にする。</P>
<HR>
<BR>
&lt;HTML&gt;<BR>
&lt;HEAD&gt;<BR>
&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=Shift_JIS&quot;&gt;<BR>
&lt;TITLE&gt;リンクで音を鳴らす&lt;/TITLE&gt;<BR>
<BR>
&lt;SCRIPT LANGUAGE=&quot;JAVASCRIPT&quot;&gt;<BR>
&lt;!--<BR>
var mfile = &quot;<B>chime.wav</B>&quot;;&nbsp;&nbsp;// 効果音のパス<BR>
<BR>
function lnkMusic(el,num) {<BR>
&nbsp;&nbsp;var ebd = '&lt;EMBED src=&quot;'+mfile+'&quot; width=&quot;0&quot; height=&quot;0&quot; autostart=&quot;true&quot; loop=&quot;false&quot; repeat=&quot;false&quot;&gt;'<BR>
&nbsp;&nbsp;if(document.all) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;document.all.msc.innerHTML = ebd;<BR>
&nbsp;&nbsp;} else if (document.layers) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;with (document.layers.msc.document) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeln(ebd);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;} else { return true; }<BR>
&nbsp;&nbsp;if (!num) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;setTimeout('jump(&quot;'+el.href+'&quot;)',<B>1400</B>);&nbsp;&nbsp;// 曲の長さによって数字を変える(1000=1秒)<BR>
&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;return false;<BR>
}<BR>
function jump(url){<BR>
&nbsp;&nbsp;location.href = url;<BR>
}<BR>
// --&gt;<BR>
&lt;/SCRIPT&gt;<BR>
<BR>
&lt;/HEAD&gt;<BR>
&lt;BODY&gt;<BR>
<BR>
&lt;DIV id=&quot;msc&quot; style=&quot;position:absolute;&quot;&gt;<BR>
&lt;EMBED src=<B>&quot;chime.wav</B>&quot; width=&quot;0&quot; height=&quot;0&quot;
autostart=&quot;false&quot; loop=&quot;false&quot;
repeat=&quot;false&quot;&gt;<BR>
&lt;/DIV&gt;<BR>
<BR>
&lt;A href=&quot;page1.html&quot; onClick=&quot;return lnkMusic(this);&quot;&gt;PAGE1&lt;/A&gt;&lt;BR&gt;<BR>
&lt;A href=&quot;#&quot; onClick=&quot;return lnkMusic(this,1);&quot;&gt;音だけ鳴らしリンクしない&lt;/A&gt;<BR>
<BR>
&lt;/BODY&gt;<BR>
&lt;/HTML&gt;<BR>
<BR><BR><BR>
</BODY>
</HTML>
