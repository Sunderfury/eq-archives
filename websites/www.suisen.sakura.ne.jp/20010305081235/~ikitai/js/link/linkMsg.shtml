<HTML>
<HEAD>
<TITLE>固定位置にリンクメッセージ</TITLE>

<SCRIPT TYPE="text/javascript" LANGUAGE="JavaScript">
<!--

var LMsg=new Array();
LMsg[0] = '<FONT size=2>固定位置にメッセージを表示することが出来ます。</FONT>';
LMsg[1] = '<FONT size=2 color=red>メッセージ部分には<FONT size=3 color=blue>タグ</FONT>や<IMG src="../../images/arrow06.gif">画像も使えます。</FONT>';
LMsg[2] = '<FONT size=2 color=blue>TABLEタグは使えません<BR>使うとMacIE５がbugでおかしくなります。他のタグは殆ど使えるはずです未確認(^^;</FONT>';
// LMsg[3] = '〜'; LMsg[4] = '〜'; のようにメッセージの数だけ用意する。
// []内の数字がメッセージ番号。


_dom=(document.all?3:(document.getElementById?1:(document.layers?2:0)));
var div;

function writeHTML(html) {
	if (_dom == 1) {
		while(div.hasChildNodes()) div.removeChild(div.lastChild);
    	var range=document.createRange();
		range.selectNodeContents(div);
		range.collapse(true);
		var cf=range.createContextualFragment(html);
		div.appendChild(cf);
	}
	if (_dom == 2) {
		div.document.open();
		div.document.write(html);
		div.document.close();
	}
	if (_dom == 3) div.innerHTML = html;
}

function showMsg(num){
	if (div) {
		writeHTML(LMsg[num]);
	    if (_dom == 1 || _dom == 3) div.style.visibility = "visible";
	    if (_dom == 2) div.visibility = "show";
	}
}

function hideMsg(){
	if (div) {
	    if (_dom == 1 || _dom == 3) div.style.visibility = "hidden";
	    if (_dom == 2) div.visibility = "hide";
	}
}

function init() {
	if (_dom == 1) div = document.getElementById("LMsg");
	if (_dom == 2) div = document.layers['parentLay'].layers['LMsg'];
	if (_dom == 3) div = document.all("LMsg");
}

window.onload = init;

// -->
</SCRIPT>

</HEAD>

<BODY>

<P><FONT size="6">固定位置にリンクメッセージ</FONT><BR>
<B><FONT color="#ff0000" size="4">
IE4/5 NN4/6</FONT></B></P>
<HR>

<!--
以下のようにA要素に onMouseOver="showMsg(0)" onMouseOut="hideMsg()" を付け加える。
showMsg(0)の数字はメッセージ番号。
-->
<TABLE border="0"><TR><TD>
<A HREF="page1.html" onMouseOver="showMsg(0)" onMouseOut="hideMsg()">メニュー１</A><BR>
<A HREF="page1.html" onMouseOver="showMsg(1)" onMouseOut="hideMsg()">メニュー２</A><BR>
<A HREF="page1.html" onMouseOver="showMsg(2)" onMouseOut="hideMsg()">メニュー３</A><BR>
</TD><TD width="50"></TD><TD>

<!--
250(幅)と50(高さ)がメッセージ領域。
-->
<!-- ↓ここから　メッセージの表示される場所にいれる -->
<TABLE border="0" CELLSPACING="0" CELLPADDING="0"><TR><TD width="250" height="50" valign="top">
<ILAYER name="parentLay"><DIV id="LMsg" style="position:absolute; width:250px; height:50px; clip:rect(0px 250px 50px 0px); visibility:hidden;"></DIV></ILAYER>
</TD></TR></TABLE>
<!-- ↑ここまで　メッセージの表示される場所にいれる -->

</TD></TR></TABLE>

<HR>

<SCRIPT type="text/javascript">
<!--
function CopyToClipBoard() {
textRange = document.body.createTextRange();
textRange.moveToElementText(source);
textRange.execCommand("Copy");
}
if ((navigator.appVersion.indexOf("MSIE") > 0) && (parseInt(navigator.appVersion) >= 4)) {
document.write('<INPUT type="button" value="ソースをクリップボードへコピー" onclick="CopyToClipBoard();">');
document.write('<BR><BR>');
}
// -->
</SCRIPT>

<DIV id="source"><TT><NOBR>
&lt;HTML><BR>
&lt;HEAD><BR>
&lt;TITLE>固定位置にリンクメッセージ&lt;/TITLE><BR>
<BR>
&lt;SCRIPT TYPE="text/javascript" LANGUAGE="JavaScript"><BR>
&lt;!--<BR>
<BR>
var LMsg=new Array();<BR>
LMsg[0] = '&lt;FONT size=2>固定位置にメッセージを表示することが出来ます。&lt;/FONT>';<BR>
LMsg[1] = '&lt;FONT size=2 color=red>メッセージ部分には&lt;FONT size=3 color=blue>タグ&lt;/FONT>や&lt;IMG src="../../images/arrow06.gif">画像も使えます。&lt;/FONT>';<BR>
LMsg[2] = '&lt;FONT size=2 color=blue>TABLEタグは使えません&lt;BR>使うとMacIE５がbugでおかしくなります。他のタグは殆ど使えるはずです未確認(^^;&lt;/FONT>';<BR>
<FONT color="#009900">
// LMsg[3] = '〜'; LMsg[4] = '〜'; のようにメッセージの数だけ用意する。</FONT><BR>
<FONT color="#009900">
// []内の数字がメッセージ番号。</FONT><BR>
<BR>
<BR>
_dom=(document.all?3:(document.getElementById?1:(document.layers?2:0)));<BR>
var div;<BR>
<BR>
function writeHTML(html) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(div.hasChildNodes()) div.removeChild(div.lastChild);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var range=document.createRange();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range.selectNodeContents(div);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range.collapse(true);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var cf=range.createContextualFragment(html);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div.appendChild(cf);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div.document.open();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div.document.write(html);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div.document.close();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) div.innerHTML = html;<BR>
}<BR>
<BR>
function showMsg(num){<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (div) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeHTML(LMsg[num]);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1 || _dom == 3) div.style.visibility = "visible";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) div.visibility = "show";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
<BR>
function hideMsg(){<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (div) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1 || _dom == 3) div.style.visibility = "hidden";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) div.visibility = "hide";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
<BR>
function init() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1) div = document.getElementById("LMsg");<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) div = document.layers['parentLay'].layers['LMsg'];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) div = document.all("LMsg");<BR>
}<BR>
<BR>
window.onload = init;<BR>
<BR>
// --><BR>
&lt;/SCRIPT><BR>
<BR>
&lt;/HEAD><BR>
<BR>
&lt;BODY><BR>
<BR>
<BR>
<FONT color="#009900">
&lt;!--</FONT><BR>
<FONT color="#009900">
以下のようにA要素に onMouseOver="showMsg(0)"
onMouseOut="hideMsg()" を付け加える。</FONT><BR>
<FONT color="#009900">
showMsg(0)の数字はメッセージ番号。</FONT><BR>
<FONT color="#009900">
--></FONT><BR>
&lt;A HREF=&quot;page1.html&quot; <B>onMouseOver=&quot;showMsg(0)&quot; onMouseOut=&quot;hideMsg()&quot;</B>&gt;メニュー１&lt;/A&gt;&lt;BR&gt;<BR>
&lt;A HREF=&quot;page1.html&quot; <B>onMouseOver=&quot;showMsg(1)&quot; onMouseOut=&quot;hideMsg()&quot;</B>&gt;メニュー２&lt;/A&gt;&lt;BR&gt;<BR>
&lt;A HREF=&quot;page1.html&quot; <B>onMouseOver=&quot;showMsg(2)&quot; onMouseOut=&quot;hideMsg()&quot;</B>&gt;メニュー３&lt;/A&gt;&lt;BR&gt;<BR>
<BR>
<BR>
<FONT color="#009900">
&lt;!--</FONT>
<FONT color="#009900">
250(幅)と50(高さ)がメッセージ領域。</FONT>
<FONT color="#009900">
--></FONT><BR>
<FONT color="#009900">
&lt;!-- ↓ここから　メッセージの表示される場所にいれる
--></FONT><BR>
&lt;TABLE border=&quot;0&quot; CELLSPACING=&quot;0&quot;
CELLPADDING=&quot;0&quot;&gt;&lt;TR&gt;&lt;TD
width=&quot;<B>250</B>&quot; height=&quot;<B>50</B>&quot; valign=&quot;top&quot;&gt;<BR>
&lt;ILAYER name=&quot;parentLay&quot;&gt;&lt;DIV
id=&quot;LMsg&quot; style=&quot;position:absolute;
width:<B>250</B>px; height:<B>50</B>px; clip:rect(0px <B>250</B>px <B>50</B>px 0px); visibility:hidden;&quot;&gt;&lt;/DIV&gt;&lt;/ILAYER&gt;<BR>
&lt;/TD>&lt;/TR>&lt;/TABLE><BR>
<FONT color="#009900">
&lt;!-- ↑ここまで　メッセージの表示される場所にいれる
--></FONT><BR>
<BR>
<BR>
&lt;/BODY><BR>
&lt;/HTML><BR>
</NOBR></TT></DIV>


</BODY>
</HTML>
