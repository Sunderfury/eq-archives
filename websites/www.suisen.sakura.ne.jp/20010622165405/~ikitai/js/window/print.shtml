<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<TITLE>印刷ボタン</TITLE>


<SCRIPT Language="JavaScript1.2">
<!--
function doPrint(){
	if (document.layers) {	// NN
	    window.print();
	} else if (document.all) {	// IE
		document.body.insertAdjacentHTML('beforeEnd',
		'<OBJECT ID="idWBPrint" WIDTH=0 HEIGHT=0 CLASSID="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2"></OBJECT>');
	    idWBPrint.ExecWB(6, 1);
	    idWBPrint.outerHTML = "";
	}
}
//-->
</SCRIPT>

</HEAD>

<BODY>
<P><B><FONT size="6">印刷ボタン</FONT></B><BR>
<B><FONT color="#ff0000" size="4">
IE4以上　NN4以上</FONT></B></P>
<HR>
<FORM>
<INPUT type="button" value="Print this page" onclick="doPrint()">
</FORM>
<HR>
<SCRIPT type="text/javascript">
<!--
function CopyToClipBoard() {
textRange = document.body.createTextRange();
textRange.moveToElementText(source);
textRange.execCommand("Copy");
}
if ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 4) && (navigator.userAgent.indexOf("Win") > 0)) {
document.write('<INPUT type="button" value="ソースをクリップボードへコピー" onclick="CopyToClipBoard();">');
document.write('<BR><BR>');
}
// -->
</SCRIPT>

<DIV id="source"><TT><NOBR>
&lt;HTML><BR>
&lt;HEAD><BR>
&lt;TITLE>印刷ボタン&lt;/TITLE><BR>
<BR>
&lt;SCRIPT Language="JavaScript1.2"><BR>
&lt;!--<BR>
function doPrint(){<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (document.layers) {&nbsp;&nbsp;// NN<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.print();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;} else if (document.all) {&nbsp;&nbsp;// IE<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.body.insertAdjacentHTML('beforeEnd',<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;OBJECT ID="idWBPrint" WIDTH=0 HEIGHT=0 CLASSID="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2">&lt;/OBJECT>');<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idWBPrint.ExecWB(6, 1);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idWBPrint.outerHTML = "";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
//--><BR>
&lt;/SCRIPT><BR>
<BR>
&lt;/HEAD><BR>
<BR>
&lt;BODY><BR>
<BR>
&lt;FORM><BR>
&lt;INPUT type="button" value="Print this page" onclick="doPrint()"><BR>
&lt;/FORM><BR>
<BR>
&lt;/BODY><BR>
&lt;/HTML><BR>
</NOBR></TT></DIV>
<HR>
<P><B><FONT size="4">補足</FONT></B><BR>
<BR>
・IE4を無視するなら<BR>
　&lt;FORM&gt;<BR>
　&lt;INPUT TYPE=&quot;button&quot; value=&quot;印刷する&quot;
onclick=&quot;window.print();&quot;&gt;<BR>
　&lt;/FORM&gt;<BR>
　だけでNN4、IE5以上に対応します。<BR>
<BR>
<BR>
・IE4対応のScriptはＭＳのＨＰを参考にしてます。(そのままとも言う(^^;）<BR>
　<A href="http://www.microsoft.com/japan/developer/workshop/author/script/dhtmlprint.asp">http://www.microsoft.com/japan/developer/workshop/author/script/dhtmlprint.asp</A>　(日本語)<BR><BR>
<BR>
・IEはヘッダやフッタなどの設定も出来るようです。詳しくはこちらをみてください。<BR>
　<A href="http://www.meadroid.com/scriptx/">http://www.meadroid.com/scriptx/</A>　(英語)<BR><BR>
<BR>
・このプリントの件に関しては試したことがないので聞かれても分かりません。<BR>
　試したくともプリンターが壊れてて・・・（使わないから新しいのを買わないだけだったりする(^^;）<BR>
<BR>
<BR>
<BR>
<BR>
</P>
</BODY>
</HTML>
