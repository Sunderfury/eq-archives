<HTML>
<HEAD>
<TITLE>部分スクロール2-2</TITLE>

<SCRIPT LANGUAGE="JavaScript">
<!--
var step = 1;		// スクロールの動く間隔。１なら１ドットずつ動く
var timer = 10;		// スクロールのスピード。1/1000秒。
var stopSpeed  = 2000;	// スクロールが止まってる時間
var blinkSpeed = 500;	// 点滅の間隔
var blinkCount = 3;		// 点滅の回数(１以上)

_dom=(document.all?3:(document.getElementById?1:(document.layers?2:0)));
var scrolled = 0, scrollHeight, blink = 0;

function startScroll() {
    if (scrolled < scrollHeight) {
		scrolled += step;
		if (_dom == 1 || _dom == 3) div.style.top = -scrolled;
		if (_dom == 2) div.top = -scrolled;
		setTimeout("startScroll()",timer);
	} else {
		scrolled = 0;
		setTimeout("blinkScroll()",stopSpeed);
	}
}

function blinkScroll() {
	blink ++;
	if (blink <= (blinkCount*2)) {
		if (blink%2 == 0) var visible = "inherit";
		else  var visible = "hidden";
		if (_dom == 1 || _dom == 3) div.style.visibility = visible;
		if (_dom == 2) div.visibility = visible;
		if (blink == (blinkCount*2-1)) {
			if (_dom == 1 || _dom == 3) div.style.top = 0;
			if (_dom == 2) div.top = 0;
		}
		setTimeout("blinkScroll()",blinkSpeed);
	} else {
		blink = 0;
		setTimeout("startScroll()",stopSpeed);
	}
}

var div;
function getScrollHight() {
	if (_dom == 1) {
		div = document.getElementById("scrollLay");
		var h = div.offsetHeight;
		var ch = parseInt(document.getElementById("clipLay").style.height);
	}
	if (_dom == 2) {
		div = document.layers['parentLay'].layers['clipLay'].layers['scrollLay'];
		var h = div.document.height;
		var ch = document.layers['parentLay'].layers['clipLay'].clip.height;
	}
	if (_dom == 3) {
		div = document.all("scrollLay");
		var h = div.offsetHeight;
		var ch = document.all("clipLay").style.pixelHeight;
	}
	if (_dom) {
		scrollHeight = h - ch;
		scrollTim=setTimeout("startScroll()",stopSpeed);
	}
}

window.onload = getScrollHight;

//-->
</SCRIPT>
</HEAD>

<BODY>
<P><B><FONT size="6">部分スクロール2-2</FONT></B><BR>
<B><FONT color="#ff0000" size="4">
IE4/5　NN4/6</FONT></B></P>
<HR>

<!--
600が表示幅、200が表示高、5が余白幅、615が枠幅、215が枠高、610はNN4の調整用。
枠の幅、高さは表示部に余白×２＋５を足す。NNの調整用は表示幅＋10を指定する。
#000000が枠の色。(注) NN4の枠の幅、高さは幅が表示部+20、高さが+10ぐらいになる。
スクロール部の背景にBODYの背景色や背景画像と違う物を使いたいときは
１番最初の<DIV>のstyleを次のようにしてください。
背景色　 style="background-color:#FF0000; border:〜〜以下元のと同じ
背景画像 style="background-image: url(kabegami.gif); border:〜〜以下元のと同じ
-->
<DIV style="border:thin solid #000000; width:615px; height:215px;">
<ILAYER name="parentLay" width="610" height="200">
<DIV id="clipLay" style="position:absolute; width:600px; height:200px; clip:rect(0px 600px 200px 0px); margin:5px;">
<DIV id="scrollLay" style="position:absolute; width:600px;">
<FONT size=2>
2000/11/2<BR>
　　・フォームに「ボタンを使ったダイナミックメニュー」を新規追加。<BR>
　　・最近ネタ切れ気味。アイデア募集〜(笑)。<BR>
　　　何か作って欲しいのあったらBBSに書いてみてください。作るかもしれません(^^;<BR>
2000/10/29<BR>
　　・「電飾」を修正。<BR>
2000/10/28<BR>
　　・フィルターに「白黒画像がカラーに」を新規追加<BR>
　　・イメージに「電飾」を新規追加<BR>
2000/10/26<BR>
　　・フィルターに「水面に映ったように」を新規追加<BR>
　　・「マウスを追いかける画像」に画像が配布出来ない(号泣)限定付きサンプルをアップ。<BR>
　　・雪降り改造版の幾つかの説明を少し変更しました。<BR>
　　　(Scriptに変更はないのでUpは表示しないことにします。)<BR>
2000/10/24<BR>
　　・雪降りTIPS新規追加<BR>
　　・「鳥」に表示されてるソースが古いバージョンのままだったのを修正。<BR>
2000/10/23<BR>
　　・メニューにJavaScript BEST 10新設。<BR>
2000/10/22<BR>
　　・↓マウスを追いかける早速修正(^^;。Speedを早くした時に変な動作をするのを修正。<BR>
　　・その他に「マウスを追いかける画像」を新規追加<BR>
2000/10/21<BR>
　　・鳥バージョンアップ。スクロールしても常に画面内を飛ぶようにした。<BR>
　　・「雪を振らせるの改造」に「左(右)から右(左)へ動かす」を新規追加。<BR>
　　・この更新情報設置。<BR>
2000/10/20<BR>
　　・鳥、テーブルの背景色変更、吹き出しでリンク説明、AUTO MIDIにソースを書いた。
</FONT>
</DIV>
</DIV>
</ILAYER>
</DIV>


<HR>
<TT>
&lt;HTML><BR>
&lt;HEAD><BR>
&lt;TITLE>部分スクロール2-2&lt;/TITLE><BR>
<BR>
&lt;SCRIPT LANGUAGE="JavaScript"><BR>
&lt;!--<BR>
var step = 1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// スクロールの動く間隔。１なら１ドットずつ動く<BR>
var timer = 10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// スクロールのスピード。1/1000秒。<BR>
var stopSpeed&nbsp;&nbsp;= 2000;&nbsp;&nbsp;&nbsp;&nbsp;// スクロールが止まってる時間<BR>
var blinkSpeed = 500;&nbsp;&nbsp;&nbsp;&nbsp;// 点滅の間隔<BR>
var blinkCount = 3;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 点滅の回数(１以上)<BR>
<BR>
_dom=(document.all?3:(document.getElementById?1:(document.layers?2:0)));<BR>
var scrolled = 0, scrollHeight, blink = 0;<BR>
<BR>
function startScroll() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (scrolled &lt; scrollHeight) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrolled += step;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1 || _dom == 3) div.style.top = -scrolled;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) div.top = -scrolled;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout("startScroll()",timer);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;} else {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrolled = 0;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout("blinkScroll()",stopSpeed);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
<BR>
function blinkScroll() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;blink ++;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (blink &lt;= (blinkCount*2)) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (blink%2 == 0) var visible = "inherit";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;var visible = "hidden";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1 || _dom == 3) div.style.visibility = visible;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) div.visibility = visible;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (blink == (blinkCount*2-1)) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1 || _dom == 3) div.style.top = 0;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) div.top = 0;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout("blinkScroll()",blinkSpeed);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;} else {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blink = 0;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout("startScroll()",stopSpeed);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
<BR>
var div;<BR>
function getScrollHight() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div = document.getElementById("scrollLay");<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var h = div.offsetHeight;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var ch = parseInt(document.getElementById("clipLay").style.height);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div = document.layers['parentLay'].layers['clipLay'].layers['scrollLay'];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var h = div.document.height;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var ch = document.layers['parentLay'].layers['clipLay'].clip.height;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div = document.all("scrollLay");<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var h = div.offsetHeight;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var ch = document.all("clipLay").style.pixelHeight;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrollHeight = h - ch;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrollTim=setTimeout("startScroll()",stopSpeed);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
}<BR>
<BR>
window.onload = getScrollHight;<BR>
<BR>
//--><BR>
&lt;/SCRIPT><BR>
&lt;/HEAD><BR>
<BR>
&lt;BODY><BR>
<BR>
<BR>
<FONT color="#00cc00">&lt;!--<BR>
<B><FONT color="#ff0000">600</FONT></B>が表示幅、<B><FONT color="#ff8000">200</FONT></B>が表示高、<B><FONT color="#ff00ff">5</FONT></B>が余白幅、<B><FONT color="#0000ff">615</FONT></B>が枠幅、<B><FONT color="#660000">215</FONT></B>が枠高、<B><FONT color="#009999">610</FONT></B>はNN4の調整用。<BR>
枠の幅、高さは表示部に余白×２＋５を足す。NNの調整用は表示幅＋10を指定する。<BR>
</FONT><FONT color="#000000"><B>#000000</B></FONT><FONT color="#00cc00">が枠の色。(注) NN4の枠の幅、高さは幅が表示部+20、高さが+10ぐらいになる。<BR>
スクロール部の背景にBODYの背景色や背景画像と違う物を使いたいときは<BR>
１番最初の&lt;DIV>のstyleを次のようにしてください。<BR>
背景色　 style="background-color:#FF0000;
border:〜〜以下元のと同じ<BR>
背景画像 style="background-image: url(kabegami.gif);
border:〜〜以下元のと同じ<BR>
--><BR>
&lt;!-- ↓ここから　表示したいところへ入れる
--&gt;</FONT><BR>
&lt;DIV style=&quot;border:thin solid <B>#000000</B>; width:<B><FONT color="#0000ff">615</FONT></B>px; height:<B><FONT color="#660000">215</FONT></B>px;&quot;&gt;<BR>
&lt;ILAYER name=&quot;parentLay&quot; width=&quot;<B><FONT color="#009999">610</FONT></B>&quot; height=&quot;<B><FONT color="#ff8040">200</FONT></B>&quot;&gt;<BR>
&lt;DIV id=&quot;clipLay&quot; style=&quot;position:absolute;
width:<B><FONT color="#ff0000">600</FONT></B>px; height:<B><FONT color="#ff8040">200</FONT></B>px; clip:rect(0px <B><FONT color="#ff0000">600</FONT></B>px <B><FONT color="#ff8040">200</FONT></B>px 0px); margin:<B><FONT color="#ff00ff">5</FONT></B>px;&quot;&gt;<BR>
&lt;DIV id=&quot;scrollLay&quot; style=&quot;position:absolute;
width:<B><FONT color="#ff0000">600</FONT></B>px;&quot;&gt;<BR><BR>
<B><FONT color="#ff0000" size="5">ここにスクロールする文章</FONT></B><BR>
<BR>
&lt;/DIV>&lt;/DIV>&lt;/ILAYER>&lt;/DIV><BR>
<FONT color="#00cc00">&lt;!-- ↑ここまで　表示したいところへ入れる
--&gt;</FONT><BR>
<BR>
<BR>
&lt;/BODY><BR>
&lt;/HTML><BR>
<BR>
</TT>


</BODY>
</HTML>

