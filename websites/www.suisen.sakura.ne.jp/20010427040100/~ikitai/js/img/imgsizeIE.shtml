<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<TITLE>ZoomImage</TITLE>


<SCRIPT language="JavaScript">
<!--

var speed = 10;
var ie=document.all?1:0

function imgZoom(name,sW,sH,eW,eH){
	this.css = (ie) ? document.all(name):name;
	this.sW = sW; this.sH = sH;
	this.eW = eW; this.eH = eH;
	this.w = eW-sW; this.h = eH-sH;
	this.state = 0;
	this.count = 0;
	this.tim;
	this.zoom = zoomimg;
    this.obj = name + "Object"; eval(this.obj + "=this");
}

function zoomimg() {
	if(document.all) {
		this.count++;
		if (this.count<=speed) {
			if (this.state) {
				this.css.width = this.eW - this.w/speed*this.count;
				this.css.height = this.eH - this.h/speed*this.count;
			} else {
				this.css.width = this.sW + this.w/speed*this.count;
				this.css.height = this.sH + this.h/speed*this.count;
			}
			this.tim=setTimeout(this.obj+".zoom()",10)
		} else {
			this.state = (this.state) ? 0:1;
			this.count=0;
			clearTimeout(this.tim);
		}
	} else {
		window.open(document.images[this.css].src,this.css,"width="+(this.eW+30)+",height="+(this.eH+30));
	}
}

function allZoom() {
	for (i=0; i<oImg.length; i++) {
		oImg[i].zoom();
	}
}

function init() {
	oImg = new Array();
	oImg[0] = new imgZoom('img0',100,60,320,200);
	oImg[1] = new imgZoom('img1',100,60,300,225);
}
onload=init;

// -->
</SCRIPT>

</HEAD>
<BODY bgcolor="white" text="black">
<P><B><FONT size="7">ズームイメージ</FONT></B><BR>
<B><FONT color="#ff0000" size="4">
ズーム機能はIE4.0以上専用。それ以外は新しいWindowに画像が出る。</FONT></B></P>
<HR>
<FORM><INPUT type="button" onclick="allZoom();" value="ALL"></FORM>

<A href="images/beast08.jpg" target="_blank" onclick="oImg[0].zoom();return false;"><IMG name="img0" SRC="images/beast08.jpg" width="100" height="60" border=0></A>

<BR><BR>

<A href="images/00000019.jpg" target="_blank" onclick="oImg[1].zoom();return false;"><IMG name="img1" SRC="images/00000019.jpg" width="100" height="60" border=0></A>

<BR><BR>
<HR>
<PRE>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;ZoomImage&lt;/TITLE&gt;

&lt;SCRIPT language=&quot;JavaScript&quot;&gt;
&lt;!--

var speed = 10;
var ie=document.all?1:0

function imgZoom(name,sW,sH,eW,eH){
  this.css = (ie) ? document.all(name):name;
  this.sW = sW; this.sH = sH;
  this.eW = eW; this.eH = eH;
  this.w = eW-sW; this.h = eH-sH;
  this.state = 0;
  this.count = 0;
  this.tim;
  this.zoom = zoomimg;
  this.obj = name + &quot;Object&quot;; eval(this.obj + &quot;=this&quot;);
}

function zoomimg() {
  if(document.all) {
    this.count++;
    if (this.count&lt;=speed) {
      if (this.state) {
        this.css.width = this.eW - this.w/speed*this.count;
        this.css.height = this.eH - this.h/speed*this.count;
      } else {
        this.css.width = this.sW + this.w/speed*this.count;
        this.css.height = this.sH + this.h/speed*this.count;
      }
      this.tim=setTimeout(this.obj+&quot;.zoom()&quot;,10)
    } else {
      this.state = (this.state) ? 0:1;
      this.count=0;
      clearTimeout(this.tim);
    }
  } else {
    window.open(document.images[this.css].src,this.css,&quot;width=&quot;+(this.eW+30)+&quot;,height=&quot;+(this.eH+30));
  }
}

function allZoom() {
  for (i=0; i&lt;oImg.length; i++) {
    oImg[i].zoom();
  }
}

function init() {
  oImg = new Array();
  <B>oImg[0] = new imgZoom('img0',100,60,320,200);</B>
  <B>oImg[1] = new imgZoom('img1',100,60,300,225);</B>
}
onload=init;

// --&gt;
&lt;/SCRIPT&gt;

&lt;/HEAD&gt;
&lt;BODY bgcolor=&quot;white&quot; text=&quot;black&quot;&gt;

&lt;FORM&gt;&lt;INPUT type=&quot;button&quot; onclick=&quot;allZoom();&quot; value=&quot;ALL&quot;&gt;&lt;/FORM&gt;

<B>&lt;A href=&quot;beast08.jpg&quot; target=&quot;_blank&quot; onclick=&quot;oImg[0].zoom();return false;&quot;&gt;
&lt;IMG name=&quot;img0&quot; SRC=&quot;beast08.jpg&quot; width=&quot;100&quot; height=&quot;60&quot; border=0&gt;
&lt;/A</B>&gt;

&lt;BR&gt;&lt;BR&gt;

<B>&lt;A href=&quot;00000019.jpg&quot; target=&quot;_blank&quot; onclick=&quot;oImg[1].zoom();return false;&quot;&gt;
&lt;IMG name=&quot;img1&quot; SRC=&quot;00000019.jpg&quot; width=&quot;100&quot; height=&quot;60&quot; border=0&gt;
&lt;/A&gt;</B>

&lt;/BODY&gt;
&lt;/HTML&gt;</PRE>
<HR>
<TABLE border="1">
  <TBODY>
    <TR>
      <TD colspan="2"><B>oImg[？]</B> = new zoomImg('<B>イメージ名</B>',<B>小横</B>,<B>小縦</B>,<B>大横</B>,<B>大縦</B>);</TD>
    </TR>
    <TR>
      <TD>oImg[？]</TD>
      <TD>？は0から始まる数字。途中の番号を飛ばしたり重なったりしないようにしてください。<BR>
      下の？と対になります。</TD>
    </TR>
    <TR>
      <TD>イメージ名</TD>
      <TD>下で設定したイメージ名を指定する。</TD>
    </TR>
    <TR>
      <TD>小横</TD>
      <TD>小さい時の横サイズ</TD>
    </TR>
    <TR>
      <TD>小縦</TD>
      <TD>小さい時の縦サイズ</TD>
    </TR>
    <TR>
      <TD>大横</TD>
      <TD>大きい時の横サイズ。画像の元サイズにするのが良い。</TD>
    </TR>
    <TR>
      <TD>大縦</TD>
      <TD>大きい時の縦サイズ。画像の元サイズにするのが良い。</TD>
    </TR>
  </TBODY>
</TABLE>
<BR>
<TABLE border="1">
  <TBODY>
    <TR>
      <TD colspan="2">&lt;A href=&quot;<B>画像のパス</B>&quot; target=&quot;_blank&quot; onclick=&quot;<B>oImg[?].zoom()</B>;return false;&quot;&gt;<BR>
      &lt;IMG name=&quot;<B>イメージ名</B>&quot; SRC=&quot;<B>画像のパス</B>&quot; width=&quot;<B>小横</B>&quot; height=&quot;<B>小縦</B>&quot; border=0&gt;<BR>
      &lt;/A&gt;</TD>
    </TR>
    <TR>
      <TD>画像のパス</TD>
      <TD>表示する画像のパス</TD>
    </TR>
    <TR>
      <TD>oImg[?].zoom()</TD>
      <TD>？は0から始まる数字。上のoImg[？]と対になる。</TD>
    </TR>
    <TR>
      <TD>イメージ名</TD>
      <TD>img? 。?はoImg[?]と同じ数字に。</TD>
    </TR>
    <TR>
      <TD>小横</TD>
      <TD>上の小横と同じ</TD>
    </TR>
    <TR>
      <TD>小縦</TD>
      <TD>上の小縦と同じ</TD>
    </TR>
    <TR>
      <TD colspan="2">補足） 横に長くなるのでサンプルは3行に分けて書いてありますが1行にまとめた方が良いです。</TD>
    </TR>
  </TBODY>
</TABLE>
<BR>
動作確認：Windows98 IE4.0/5.5 NN4.7
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
</BODY>
</HTML>
