
<HTML>
<HEAD>
<TITLE>ネオンテキスト</TITLE>

<SCRIPT LANGUAGE="JavaScript">
<!--

var neonMsg = "ネオンテキスト";			// 表示するテキスト
var neonTimer = 100;					// 色の変わるspeed
var msgFont = "ＭＳ Ｐ明朝,平成明朝";	// フォント
var msgSize = 50;						// 文字の大きさ。単位 px
var neonColorFlag = 0;	// 色の付け方。ランダム：0　指定：1

// 色の指定。neonColorFlag=1の場合に指定する。数は何個でもＯＫ。
// #FFFFXX のように一部をXX にするとXX の部分はランダムに決まります。
// var neonColor = new Array('#FFXXXX') とすると赤系だけの色でランダムになります。
// 青系なら #XXXXFF。緑系なら #XXFFXX。
var neonColor = new Array('#FFFFFF','#00FFFF','#FF00FF','#FFFF00','#FF0000','#00FF00','#0000FF');



_dom=(document.all?3:(document.getElementById?1:(document.layers?2:0)));
var hextbl='0123456789ABCDEF'; var used = "";

function num2hex(n){
	return hextbl.charAt(Math.floor(n / 16)) + hextbl.charAt(n % 16);
}

function writeHTML(html) {
	if (_dom == 1) {
		while(div.hasChildNodes()) div.removeChild(div.lastChild);
    	var range=document.createRange();
		range.selectNodeContents(div);
		range.collapse(true);
		var cf=range.createContextualFragment(html);
		div.appendChild(cf);
	}
	if (_dom == 2) {
		div.document.open();
		div.document.write(html);
		div.document.close();
	}
	if (_dom == 3) div.innerHTML = html;
}

function createColor()	{
	if (neonColorFlag) {
		do {
			textColor = neonColor[Math.floor(Math.random()*neonColor.length)];
			if (textColor.match(/XX/) != null) {
				textColor = textColor.replace(/XX/g,num2hex(Math.floor(Math.random()*170)));
			}
		} while (used == textColor);
		used = textColor;
	} else {
		var textColor = "#";
		for (var i = 0 ; i < 3 ; i++) {
			textColor += num2hex(Math.floor(Math.random()*255));
		}
	}
	return textColor;
}

function neonText()	{
	var neonHTML = ""
	for(var i = 0 ; i < neonMsg.length; i++)	{
		neonHTML += "<FONT COLOR='"
		+ createColor() + "' face='" + msgFont + "' style='font-size:" + msgSize + "px'>"
		+ neonMsg.substring(i,i+1) + "</FONT>";
	}
	writeHTML(neonHTML);
	neonTim = setTimeout("neonText()",neonTimer);
}

function cancelNeon() {
	clearTimeout(neonTim);
}

function init() {
	div = "";
	if (_dom == 1) div = document.getElementById("LMsg");
	if (_dom == 2) div = document.layers['parentLay'].layers['LMsg'];
	if (_dom == 3) div = document.all("LMsg");
	if (div) neonText();
}

window.onload = init;
window.onunload = cancelNeon;

// -->
</SCRIPT>

</HEAD>
<BODY BGCOLOR="black" TEXT="white">

<!-- 300(幅)と50(高さ)がメッセージ領域。-->
<!-- ↓ここから　メッセージの表示される場所にいれる -->
<TABLE border="0" CELLSPACING="0" CELLPADDING="0"><TR><TD width="300" height="50" valign="top">
<ILAYER name="parentLay"><DIV id="LMsg" style="position:absolute; width:300px; height:50px; clip:rect(0px 300px 50px 0px);"></DIV></ILAYER>
</TD></TR></TABLE>
<!-- ↑ここまで　メッセージの表示される場所にいれる -->
IE4以上 NN4.06以上
<HR>
<P>水色をHEAD内へ入れる。<BR>
黄色を表示したいところへ入れてテキストに合わせてメッセージ領域を調整する。</P>
<HR>


<SCRIPT type="text/javascript" language="JavaScript1.2">
<!--
	function CopyToClipBoard() {
	textRange = document.body.createTextRange();
	textRange.moveToElementText(source);
	textRange.execCommand("Copy");
}
if ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 4) && (navigator.userAgent.indexOf("Win") > 0)) {
	document.write('<INPUT type="button" value="ソースをクリップボードへコピー" onclick="CopyToClipBoard();">');
	document.write('<BR><BR>');
}
// -->
</SCRIPT>

<DIV id="source"><TT><NOBR><BR>
&lt;HTML><BR>
&lt;HEAD><BR>
&lt;TITLE>ネオンテキスト&lt;/TITLE><BR>
<BR>
<FONT color="#00ffff">&lt;SCRIPT LANGUAGE="JavaScript"><BR>
&lt;!--<BR>
<BR>
var neonMsg = "ネオンテキスト";&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 表示するテキスト<BR>
var neonTimer = 100;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 色の変わるspeed<BR>
var msgFont = "ＭＳ Ｐ明朝,平成明朝";&nbsp;&nbsp; // フォント<BR>
var msgSize = 50;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 文字の大きさ。単位 px<BR>
var neonColorFlag = 0;&nbsp;&nbsp;// 色の付け方。ランダム：0　指定：1<BR>
<BR>
// 色の指定。neonColorFlag=1の場合に指定する。数は何個でもＯＫ。<BR>
// #FFFFXX のように一部をXX にするとXX の部分はランダムに決まります。<BR>
// var neonColor = new Array('#FFXXXX') とすると赤系だけの色でランダムになります。<BR>
// 青系なら #XXXXFF。緑系なら #XXFFXX。<BR>
var neonColor = new Array('#FFFFFF','#00FFFF','#FF00FF','#FFFF00','#FF0000','#00FF00','#0000FF');<BR>
<BR>
<BR>
<BR>
_dom=(document.all?3:(document.getElementById?1:(document.layers?2:0)));<BR>
var hextbl='0123456789ABCDEF'; var used = "";<BR>
<BR>
function num2hex(n){<BR>
&nbsp;&nbsp;&nbsp;&nbsp;return hextbl.charAt(Math.floor(n / 16)) + hextbl.charAt(n % 16);<BR>
}<BR>
<BR>
function writeHTML(html) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(div.hasChildNodes()) div.removeChild(div.lastChild);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var range=document.createRange();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range.selectNodeContents(div);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range.collapse(true);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var cf=range.createContextualFragment(html);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div.appendChild(cf);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div.document.open();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div.document.write(html);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div.document.close();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) div.innerHTML = html;<BR>
}<BR>
<BR>
function createColor()&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (neonColorFlag) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textColor = neonColor[Math.floor(Math.random()*neonColor.length)];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (textColor.match(/XX/) != null) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textColor = textColor.replace(/XX/g,num2hex(Math.floor(Math.random()*170)));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} while (used == textColor);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;used = textColor;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;} else {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var textColor = "#";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (var i = 0 ; i &lt; 3 ; i++) {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textColor += num2hex(Math.floor(Math.random()*255));<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;return textColor;<BR>
}<BR>
<BR>
function neonText() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;var neonHTML = ""<BR>
&nbsp;&nbsp;&nbsp;&nbsp;for(var i = 0 ; i &lt; neonMsg.length; i++)&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neonHTML += "&lt;FONT COLOR='"<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ createColor() + "' face='" + msgFont + "' style='font-size:" + msgSize + "px'>"<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ neonMsg.substring(i,i+1) + "&lt;/FONT>";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;writeHTML(neonHTML);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;neonTim = setTimeout("neonText()",neonTimer);<BR>
}<BR>
<BR>
function cancelNeon() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;clearTimeout(neonTim);<BR>
}<BR>
<BR>
function init() {<BR>
&nbsp;&nbsp;&nbsp;&nbsp;div = "";<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 1) div = document.getElementById("LMsg");<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 2) div = document.layers['parentLay'].layers['LMsg'];<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (_dom == 3) div = document.all("LMsg");<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (div) neonText();<BR>
}<BR>
<BR>
window.onload = init;<BR>
window.onunload = cancelNeon;<BR>
<BR>
// --><BR>
&lt;/SCRIPT></FONT><BR>
<BR>
&lt;/HEAD><BR>
&lt;BODY BGCOLOR="black" TEXT="white"><BR>
<BR>
<FONT color="#ffff00">&lt;!-- 300(幅)と50(高さ)がメッセージ領域。--&gt;<BR>
&lt;!-- ↓ここから　メッセージの表示される場所にいれる --><BR>
&lt;TABLE border="0" CELLSPACING="0" CELLPADDING="0">&lt;TR>&lt;TD width="300" height="50" valign="top"><BR>
&lt;ILAYER name="parentLay">&lt;DIV id="LMsg" style="position:absolute; width:300px; height:50px; clip:rect(0px 300px 50px 0px);">&lt;/DIV>&lt;/ILAYER><BR>
&lt;/TD>&lt;/TR>&lt;/TABLE><BR>
&lt;!-- ↑ここまで　メッセージの表示される場所にいれる --></FONT><BR>
<BR>
<BR>
<BR>
<BR>
<BR>
&lt;/BODY><BR>
&lt;/HTML><BR>
<BR>
</NOBR></TT></DIV>



</BODY>
</HTML>

