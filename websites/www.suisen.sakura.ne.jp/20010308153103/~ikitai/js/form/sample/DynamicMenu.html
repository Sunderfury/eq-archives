<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=shift_jis">
<TITLE>ボタンを使ったダイナミックメニュー</TITLE>
<STYLE type="text/css">
<!--
INPUT.button {
    font-weight : bold;
    color : #FF3366;
    background-color : white;
}

INPUT.menu {
    font-weight : bold;
    color : #FF3366;
    background-color : white;
}
-->
</STYLE>

</HEAD>

<BODY>
<FORM name="dynaMenu">

<INPUT type="button" class="button" name="btn" onFocus="this.blur()" onClick="mMenu(0)" value="サンプル１"><!--
 --><INPUT type="button" class="menu" name="menu0" onFocus="this.blur()" value="  _top  " onClick="jump('page1.html','_top')"><!--
 --><INPUT type="button" class="menu" name="menu0" onFocus="this.blur()" value=" _self " onClick="jump('page1.html','_self')"><!--
 --><INPUT type="button" class="menu" name="menu0" onFocus="this.blur()" value="_blank" onClick="jump('page1.html','_blank')"><!--
 --><INPUT type="button" class="menu" name="menu0" onFocus="this.blur()" value="  ue  " onClick="jump('page1.html','ue')"><!--
 --><INPUT type="button" class="menu" name="menu0" onFocus="this.blur()" value=" sita " onClick="jump('page1.html','sita')"><!--
 --><INPUT type="button" class="menu" name="menu0" onFocus="this.blur()" value="指定無し" onClick="jump('page1.html')"><BR>

<INPUT type="button" class="button" name="btn" onFocus="this.blur()" onClick="mMenu(1)" value="サンプル２"><!--
 --><INPUT type="button" class="menu" name="menu1" onFocus="this.blur()" value="バルーン" onClick="jump('../../yuki/balloon.shtml','_top')"><!--
 --><INPUT type="button" class="menu" name="menu1" onFocus="this.blur()" value="水族館" onClick="jump('../../yuki/fish.shtml','_self')"><!--
 --><INPUT type="button" class="menu" name="menu1" onFocus="this.blur()" value="　鳥　" onClick="jump('../../yuki/tori.shtml','_blank')"><!--
 --><INPUT type="button" class="menu" name="menu1" onFocus="this.blur()" value="水　槽" onClick="jump('../../yuki/suisou.shtml','ue')"><!--
 --><INPUT type="button" class="menu" name="menu1" onFocus="this.blur()" value="　星　" onClick="jump('../../yuki/snow2.shtml','sita')"><!--
 --><INPUT type="button" class="menu" name="menu1" onFocus="this.blur()" value="電　飾" onClick="jump('../../img/border.shtml')"><BR>

</FORM>
サンプル２は１と開き方が対になってます。
<HR>
このフレーム名は「ue」<BR>
<TABLE border="1" cellpadding="3" cellspacing="0">
<TR><TD>_top</TD><TD>jump('URL','_top')</TD><TD>フレームを解除して表示</TD></TR>
<TR><TD>_self</TD><TD>jump('URL','_self')</TD><TD>同じWindow(フレーム)に表示</TD></TR>
<TR><TD>_blank</TD><TD>jump('URL','_blank')</TD><TD>新しいWindowに表示</TD></TR>
<TR><TD>フレーム名</TD><TD>jump('URL','フレーム名')</TD><TD>指定フレームに表示</TD></TR>
<TR><TD>指定無し</TD><TD>jump('URL')</TD><TD>同じWindow(フレーム)に表示</TD></TR>
</TABLE>
<PRE>&lt;FORM name=&quot;dynaMenu&quot;&gt;

&lt;INPUT type=&quot;button&quot; class=&quot;button&quot; name=&quot;btn&quot; onFocus=&quot;this.blur()&quot; onClick=&quot;mMenu(0)&quot; value=&quot;サンプル１&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu0&quot; onFocus=&quot;this.blur()&quot; value=&quot;  _top  &quot; onClick=&quot;jump('page1.html','<B>_top</B>')&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu0&quot; onFocus=&quot;this.blur()&quot; value=&quot; _self &quot; onClick=&quot;jump('page1.html','<B>_self</B>')&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu0&quot; onFocus=&quot;this.blur()&quot; value=&quot;_blank&quot; onClick=&quot;jump('page1.html','<B>_blank</B>')&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu0&quot; onFocus=&quot;this.blur()&quot; value=&quot;  ue  &quot; onClick=&quot;jump('page1.html','<B>ue</B>')&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu0&quot; onFocus=&quot;this.blur()&quot; value=&quot; sita &quot; onClick=&quot;jump('page1.html','<B>sita</B>')&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu0&quot; onFocus=&quot;this.blur()&quot; value=&quot;指定無し&quot; onClick=&quot;jump('page1.html')&quot;&gt;&lt;BR&gt;

&lt;INPUT type=&quot;button&quot; class=&quot;button&quot; name=&quot;btn&quot; onFocus=&quot;this.blur()&quot; onClick=&quot;mMenu(1)&quot; value=&quot;サンプル２&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu1&quot; onFocus=&quot;this.blur()&quot; value=&quot;バルーン&quot; onClick=&quot;jump('../../yuki/balloon.shtml','<B>_top</B>')&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu1&quot; onFocus=&quot;this.blur()&quot; value=&quot;水族館&quot; onClick=&quot;jump('../../yuki/fish.shtml','<B>_self</B>')&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu1&quot; onFocus=&quot;this.blur()&quot; value=&quot;　鳥　&quot; onClick=&quot;jump('../../yuki/tori.shtml','<B>_blank</B>')&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu1&quot; onFocus=&quot;this.blur()&quot; value=&quot;水　槽&quot; onClick=&quot;jump('../../yuki/suisou.shtml','<B>ue</B>')&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu1&quot; onFocus=&quot;this.blur()&quot; value=&quot;　星　&quot; onClick=&quot;jump('../../yuki/snow2.shtml','<B>sita</B>')&quot;&gt;&lt;!--
 --&gt;&lt;INPUT type=&quot;button&quot; class=&quot;menu&quot; name=&quot;menu1&quot; onFocus=&quot;this.blur()&quot; value=&quot;電　飾&quot; onClick=&quot;jump('../../img/border.shtml')&quot;&gt;&lt;BR&gt;

&lt;/FORM&gt;</PRE>
<SCRIPT language="JavaScript1.2" type="text/javascript">
<!--

var speed = 40;	// Menuのアニメスピード。
var start = 1;	// アクセス時のMenuのアニメのON OFF。1がON,0がOFF
var move = 1;	// menuのアニメのON OFF。1がON,0がOFF。

function mMenu(num) {
	if (document.all) {
		if (flag[num]) {
			if (menuFlag[num]) { pushMenu(num,maxMenu[num]); menuFlag[num] = false; }
			else { pullMenu(num,maxMenu[num]-1); menuFlag[num] = true; }
		}
	}
}

function pushMenu(num,no) {
	flag[num] = false;
	if (move) {
		if (document.dynaMenu.elements["menu"+num][now[num]].style.pixelWidth < menuWidth[num][now[num]] ) {
			document.dynaMenu.elements["menu"+num][now[num]].style.pixelWidth += speed;
		} else { now[num] += 1; }
		if (now[num] < no) { tim[num] = setTimeout('pushMenu('+num+','+no+')',0); }
		else { document.dynaMenu.btn[num].value = btnValue[num]+" <"; now[num] = 0; clearTimeout(tim[num]); flag[num] = true; }
	} else {
		for (i=0; i<no; i++) {
			document.dynaMenu.elements["menu"+num][i].style.pixelWidth = menuWidth[num][i];
		}
		document.dynaMenu.btn[num].value = btnValue[num]+" <"; flag[num] = true;
	}
}

function pullMenu(num,no) {
	flag[num] = false;
	if (move) {
		if (document.dynaMenu.elements["menu"+num][no].style.pixelWidth > 0 ) {
			document.dynaMenu.elements["menu"+num][no].style.pixelWidth -= speed;
		} else { no -= 1; }
		if (no >= 0) { tim[num] = setTimeout('pullMenu('+num+','+no+')',0); }
		else { document.dynaMenu.btn[num].value = btnValue[num]+" >"; clearTimeout(tim[num]); flag[num] = true; }
	} else {
		for (i=0; i<=no; i++) {
			document.dynaMenu.elements["menu"+num][i].style.pixelWidth = 0;
		}
		document.dynaMenu.btn[num].value = btnValue[num]+" >"; flag[num] = true;
	}
}

function jump(url,how) {
	if (how=="_top") top.location.href=url;
	else if (how=="_self") self.location.href=url;
	else if (how=="_blank") window.open(url);
	else if (parent.frames[how]) parent.frames[how].location.href=url;
	else location.href = url;
}

if (document.all) {
	maxBtn = document.dynaMenu.btn.length; menuWidth = new Array(); var maxSize = 0;
	maxMenu = new Array(); menuFlag = new Array(); btnValue = new Array();
	now = new Array(); tim = new Array(); flag = new Array(); sumWidth =  new Array();
	for (j=0; j<maxBtn; j++) {
		document.dynaMenu.btn[j].style.textAlign = "right";
		if (maxSize < document.dynaMenu.btn[j].offsetWidth) maxSize = document.dynaMenu.btn[j].offsetWidth
	}
	for (j=0; j<maxBtn; j++) {
		var menu = document.dynaMenu.elements["menu"+j]; menuWidth[j] = new Array();
		maxMenu[j] = menu.length; menuFlag[j] = true; now[j] = 0; flag[j] = true;
		btnValue[j] = document.dynaMenu.btn[j].value;
		document.dynaMenu.btn[j].value += " >";
		document.dynaMenu.btn[j].style.width = maxSize;
		for (i=0; i<maxMenu[j]; i++) {
			menuWidth[j][i] = menu[i].offsetWidth;
			menu[i].style.width = menuWidth[j][i];
			if (!start) menu[i].style.pixelWidth = -menuWidth[j][i]%speed;
		}
		if (start) pullMenu(j,maxMenu[j]-1);
	}
}

// -->
</SCRIPT>

</BODY>
</HTML>
